!function(){"use strict";function o(){return window.zyxplay.context}function z(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","path");return e.appendChild(i),i.setAttribute("d",t),i.setAttribute("fill","none"),i.setAttribute("stroke","black"),i.setAttribute("stroke-width","2"),i.setAttribute("id","path"),i}function L(t){return t*Math.PI/180}function C(t,e,i){return Math.min(Math.max(t,i),e)}function x(t){let{x:e=0,y:i=0,width:s,height:h}=t;return e-=.5*s,i-=.5*h,s<0&&(e+=s,s*=-1),h<0&&(i+=h,h*=-1),{x:e,y:i,width:s,height:h}}function k(t,e,...i){return setTimeout(t,e,...i)}function _(t=0,e=1){return Math.random()*(e-t)+t}let r={};function H(t,e){r[t]=r[t]||[],r[t].push(e)}function N(t,...e){(r[t]||[]).map(t=>t(...e))}let n={},D={};function g(t,e){return new URL(t,e).href}function m(){window.__k||(window.__k={u:g,i:n,d:D})}function t(t,e,i){if(m(),D[t])return D[t];D[t]=e(...i)}function e(h,r=null){return m(),new Promise((t,e)=>{let i,s;return r?(n[h]=r,t(r)):n[h]?t(n[h]):((i=new Image).onload=()=>{s=g(h,window.location.href),n[s]=n[h]=i,t(i)},i.onerror=()=>{e()},void(i.src=h))})}class i{constructor(t){this.init(t)}init(t={}){t={name:"",x:0,y:0,width:8,height:8,rotation:0,scaleX:1,scaleY:1,anchor:{x:0,y:0},color:"white",dx:0,dy:0,ddx:0,ddy:0,ttl:1/0,frame:0,sprite:0,context:o(),spritesheet:[n["spritesheet.png"],8,8],shield:20,hitted:!1,_uf:t.update,_rf:t.render,_df:t.draw,...t};Object.assign(this,t)}hit(t){N("hit"),this.shield-=t,this.hitted=!0,this.shield<=0&&this.die&&this.die(),k(()=>this.hitted=!1,100)}advance(){this.x+=this.dx,this.y+=this.dy,this.dx+=this.ddx,this.dy+=this.ddy,this.ttl--,this.frame++}update(){this._uf?this._uf():this.advance()}render(){if(this._rf)return this._rf();var{context:t,x:e,y:i,anchor:s,rotation:h,scaleX:r,scaleY:n,width:a,height:o}=this;t.save(),t.translate(e,i),h&&t.rotate(h),r&&n&&t.scale(r,n),t.translate(-a*s.x,-o*s.y),this.draw(),t.restore()}draw(){if(this._df)return this._df();var{context:t,color:e,width:i,height:s}=this;this.hitted&&(t.save(),t.translate(0,-1)),this.color?(t.fillStyle=e,t.fillRect(0,0,i,s)):t.drawImage(this.spritesheet[0],this.sprite*this.spritesheet[1],0,i,s,0,0,i,s),this.hitted&&(t.globalCompositeOperation="source-atop",t.fillStyle="white",t.fillRect(0,0,i,s),t.globalCompositeOperation="source-over",t.restore())}isAlive(){return 0<this.ttl}}const j=t=>new i(t);class y{constructor(t){this.init(t)}init(i={}){var t=Object.keys(i).reduce((t,e)=>("function"!=typeof i[e]&&(t[e]=i[e]),t),{}),t={id:"scene",context:o(),_uf:i.update,_rf:i.render,children:[],paused:!1,...t};Object.assign(this,t)}add(t){this.children.push(t)}pause(){this.paused=!0}resume(){this.paused=!1}update(e){this.paused||(this.children.forEach(t=>{if(!t.isAlive)return t.update(e);t.isAlive()&&t.update(e)}),this._uf&&this._uf())}render(){this.context.save(),this._uf&&this._uf(),this.children.forEach(t=>{if(!t.isAlive)return t.render();t.isAlive()&&t.render()}),this.context.restore()}}function P(t){return new y(t)}class w extends i{constructor(t={}){super({name:"text",x:0,y:0,text:"",color:"white",align:"left",lineHeight:8,scale:1,spritesheet:n["font.png"],...t})}draw(){var t=this.text.split("\n");const{context:r,align:e,lineHeight:n,color:a}=this;r.save(),t.forEach(i=>{r.save(),"center"===e&&r.translate(8*-i.length/2,0),"right"===e&&r.translate(8*-i.length,0);for(let e=0;e<i.length;e++){var s,h=i.charCodeAt(e);let t=64===h?41:58===h?40:33===h?39:63===h?38:44===h?37:46===h?36:32===h?-1:48<=h&&h<=57?h-22:65<=h&&h<=90?h-65:0;-1!==t&&(h=8*t,s=8*e,0,r.drawImage(this.spritesheet,h,0,8,8,s,0,8,8),r.globalCompositeOperation="source-atop",r.fillStyle=a||"white",r.fillRect(s,0,8,8),r.globalCompositeOperation="source-over")}r.restore(),r.translate(0,n)}),r.restore()}}function Y(t){return new w(t)}class v extends i{constructor(t){super({name:"explosion-particle",color:"white",anchor:{x:.5,y:.5},...t})}update(){!this.color&&this.ttl<30&&(this.scaleX=this.scaleY=this.ttl/30),this.color&&this.ttl<60&&(this.scaleX=this.scaleY=this.ttl/60),this.advance()}draw(){this.color||this.context.drawImage(this.spritesheet[0],128,0,8,8,0,0,8,8),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,1,1))}}function $(t){return new v(t)}let a={},l={},s={},d={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function O(t=()=>{},e){t._pd&&e.preventDefault(),t(e)}function E(t){var e=d[t.code],i=a[e];s[e]=!0,O(i,t)}function S(t){var e=d[t.code],i=l[e];s[e]=!1,O(i,t)}function h(t){return[].concat(t).some(t=>s[t])}function U(t,e,{handler:i="keydown",preventDefault:s=!0}={}){let h="keydown"==i?a:l;e._pd=s,[].concat(t).map(t=>h[t]=e)}function q(t,{handler:e="keydown"}={}){let i="keydown"==e?a:l;[].concat(t).map(t=>delete i[t])}const G=(...t)=>{let e=c.createBufferSource(),i=c.createBuffer(t.length,t[0].length,F);return t.map((t,e)=>i.getChannelData(e).set(t)),e.buffer=i,e.connect(c.destination),e.start(),e},R=(t=1,e=.05,i=220,s=0,h=0,r=.1,n=0,a=1,o=0,l=0,d=0,c=0,p=0,f=0,u=0,x=0,g=0,m=1,y=0,w=0)=>{let v=2*Math.PI,O=o*=500*v/F**2,E=(0<u?1:-1)*v/4,S=i*=(1+2*e*Math.random()-e)*v/F,T=[],b=0,A=0,I=0,R=1,M=0,z=0,L=0,C,k;for(s=99+F*s,y*=F,h*=F,r*=F,g*=F,l*=500*v/F**3,u*=v/F,d*=v/F,c*=F,p=F*p|0,k=s+y+h+r+g|0;I<k;T[I++]=L)++z%(100*x|0)||(L=n?1<n?2<n?3<n?Math.sin((b%v)**3):Math.max(Math.min(Math.tan(b),1),-1):1-(2*b/v%2+2)%2:1-4*Math.abs(Math.round(b/v)-b/v):Math.sin(b),L=(p?1-w+w*Math.sin(2*Math.PI*I/p):1)*(0<L?1:-1)*Math.abs(L)**a*t*J*(I<s?I/s:I<s+y?1-(I-s)/y*(1-m):I<s+y+h?m:I<k-g?(k-I-g)/r*m:0),L=g?L/2+(g>I?0:(I<k-g?1:(k-I)/g)*T[I-g|0]/2):L),C=(i+=o+=l)*Math.sin(A*u-E),b+=C-C*f*(1-1e9*(Math.sin(I)+1)%2),A+=C-C*f*(1-1e9*(Math.sin(I)**2+1)%2),R&&++R>c&&(i+=d,S+=d,R=0),!p||++M%p||(i=S,o=O,R=R||1);return T},J=.3,F=44100,c=new(window.AudioContext||webkitAudioContext);class Q extends i{init(t){t={name:"ship",spawning:!0,y:248,imune:!1,dying:!1,shield:100,lives:3,score:0,fireLevel:0,firing:!1,fireTimeout:null,anchor:{x:.5,y:.5},sprite:1,...t};super.init(t),this.spawn()}powerUp(t){G(D.powerup),"shield"===t.type&&(this.shield+=50,100<this.shield)&&(this.shield=100),"fire"===t.type&&(this.fireLevel++,4<this.fireLevel&&(this.fireLevel=4),clearTimeout(this.fireTimeout),N("start-fire-timer"),this.fireTimeout=k(()=>{N("end-fire-timer"),4===this.fireLevel&&(this.fireLevel=3)},3e4))}fire(){this.firing||(this.firing=!0,N("ship-fire",this.x-1,this.y-8,_(-.3,.3)),0<this.fireLevel&&N("ship-fire",this.x-1,this.y-8,_(-.5,.5)),1<this.fireLevel&&k(()=>{N("ship-fire",this.x-1,this.y-8,_(-.3,.3)),N("ship-fire",this.x-1,this.y-8,_(-.5,.5))},100),2<this.fireLevel&&k(()=>{N("ship-fire",this.x-1,this.y-8,-2),N("ship-fire",this.x-1,this.y-8,2)},400),3<this.fireLevel&&k(()=>{N("ship-fire",this.x-16,this.y-4,_(-.1,.1)),N("ship-fire",this.x+14,this.y-4,_(-.1,.1))},200),k(()=>{this.firing=!1},200))}die(){N("ship-die"),N("explosion",this.x,this.y-4,60,4,"white"),this.dying=!0,this.ttl=0,this.lives--,this.imune=!0,this.dx=0,this.ddx=0,this.x=128,k(()=>{this.spawn()},1e3)}spawn(){this.imune=!0,this.spawning=!0,this.ttl=1/0,this.y=248,this.frame=0,this.shield=100,this.fireLevel=3,k(()=>{this.spawning=!1,this.imune=!1},1e3)}update(){this.ddx=0,this.ddy=0,this.dx*=.96,this.dy*=.96,this.sprite=1,h(["d","arrowright"])&&this.dx<5&&(this.ddx=.2,this.sprite=2),h(["a","arrowleft"])&&-5<this.dx&&(this.ddx=-.2,this.sprite=0),this.spawning||(h(["s","arrowdown"])&&this.dy<5&&(this.ddy=.2),h(["w","arrowup"])&&-5<this.dy&&(this.ddy=-.2)),!this.firing&&h("space")&&this.fire(),this.spawning&&(this.ddy=-.03,this.scaleX=this.scaleY=C(1,2,2-this.frame/60)),this.shield<=0&&this.die(),this.advance(),this.x<4&&(this.x=4,this.dx=0),252<this.x&&(this.x=252,this.dx=0),this.y<4&&(this.y=4,this.dy=0),236<this.y&&(this.y=236,this.dy=0)}draw(){var{context:t,width:e,height:i}=this;t.drawImage(this.spritesheet[0],this.spritesheet[1]*this.sprite,0,e,i,0,0,e,i);let s=1;this.ddy<0&&(s=this.frame%10<5?2:3),t.fillStyle="#FFaa33",t.fillRect(3,7,2,s),t.fillStyle="#FF6633",t.fillRect(this.frame%10<5?3:4,7+s,1,s),4===this.fireLevel&&(t.fillStyle="#FFF",t.fillRect(18,4,2,2),t.fillRect(-12,4,2,2)),this.hitted&&(t.globalCompositeOperation="source-atop",t.fillStyle="red",t.fillRect(0,0,e,i),t.globalCompositeOperation="source-over")}}class T{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t({id:""}))||!(i.update&&i.init&&i.isAlive&&i.render))throw Error("Must provide create() function which returns an object with init(), update(), render(), and isAlive() functions");this._c=t,this.objects=[t({id:""})],this.size=0,this.maxSize=e}get(t={}){if(this.size==this.objects.length){if(this.size==this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.push(this._c())}var e=this.objects[this.size];return this.size++,e.init(t),e}getAliveObjects(){return this.objects.slice(0,this.size)}clear(){this.size=this.objects.length=0,this.objects.push(this._c())}update(e){var i;let s=!1;for(let t=this.size;t--;)(i=this.objects[t]).update(e),i.isAlive()||(s=!0,this.size--);s&&this.objects.sort((t,e)=>e.isAlive()-t.isAlive())}render(){for(let t=this.size;t--;)this.objects[t].render()}}function V(t){return new T(t)}function W(e=1){var i=V({create:j,maxSize:241});i.increaseVel=function(e){this.objects.forEach(t=>{t.dy=t.dy*e})},i.decreaseVel=function(e){this.objects.forEach(t=>{t.dy=t.dy/e})},i.velocity=e;for(let t=0;t<240;t++){var s=_(1,3)*e,h=Math.floor(s/e*50)+50;i.get({x:Math.floor(_(0,256)),y:t,width:1,height:1,dy:s/4,color:`rgb(${h}, ${h}, ${h})`,update(){this.advance(),240<this.y&&(this.y=0)}})}return i.isAlive=()=>!0,i}class b extends i{init(t){t={name:"asteroid",spritesheet:[n["spritesheet16.png"],16,16],sprite:2,width:16,height:16,color:null,anchor:{x:.5,y:.5},shield:10,...t};super.init(t)}die(){N("explosion",this.x,this.y,50,4,"white"),N("score",10),this.ttl=0}update(){this.rotation=this.frame/(10/this.dy),this.advance(),this.x<0||264<this.x||248<this.y&&(this.ttl=0)}}function tt(t){return new b(t)}function A(t,e){var i=[],s=e.x+e.width/2,e=e.y+e.height/2,h=t.y<e,e=t.y+t.height>=e;return t.x<s&&(h&&i.push(0),e)&&i.push(2),t.x+t.width>=s&&(h&&i.push(1),e)&&i.push(3),i}class I{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;t=o().canvas;this.bounds=i||{x:0,y:0,width:t.width,height:t.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map(t=>{t.clear()}),this._b=!1,this._o.length=0}get(e){let i=new Set;return this._s.length&&this._b?(A(e,this.bounds).map(t=>{this._s[t].get(e).map(t=>i.add(t))}),Array.from(i)):this._o.filter(t=>t!==e)}add(...t){t.flat().map(t=>{this._b?this._a(t):(this._o.push(t),this._o.length>this.maxObjects&&this._d<this.maxDepth&&(this._sp(),this._o.map(t=>this._a(t)),this._o.length=0))})}_a(e){A(e,this.bounds).map(t=>{this._s[t].add(e)})}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,i=0;i<4;i++)this._s[i]=new I({bounds:{x:this.bounds.x+(i%2==1?t:0),y:this.bounds.y+(2<=i?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1}}function X(t){return new I(t)}class M extends i{init(t){t={name:"enemy",sprite:3,color:null,anchor:{x:.5,y:.5},shield:1,frame:0,loop:!0,firstRun:!0,debryColor:"white",fireRate:200,speed:1,...t};super.init(t),this.path&&(this.ttl=Math.floor(t.path.getTotalLength()/this.speed)),this.loop&&(this.ttl=1/0)}fire(){N("enemy-fire",this.x-4,this.y-4,this.rotation,3)}die(){N("explosion",this.x,this.y,30,3,this.debryColor),N("score",10),this.ttl=0}update(){var t,e;this.rotation=L(180),this.path?(t=this.path.getPointAtLength(this.frame*this.speed),e=this.path.getPointAtLength(this.frame*this.speed+1),this.x=Math.floor(t.x),this.y=Math.floor(t.y),this.rotate&&(this.rotation=L(90)+Math.atan2(e.y-t.y,e.x-t.x))):(this.x=this.parent.x+Math.cos(this.frame/this.parent.childrenSpeed+this.anglePlacement)*this.parent.childrenRadius,this.y=this.parent.y+Math.sin(this.frame/this.parent.childrenSpeed+this.anglePlacement)*this.parent.childrenRadius),this.firstRun&&(this.scaleX=this.scaleY=C(0,1,(this.frame*this.speed+1)/100)),!this.loop&&this.ttl<100&&(this.scaleX=this.scaleY=C(0,1,this.ttl/100)),this.scaleX<1&&(this.imune=!0),1<=this.scaleX&&(this.imune=!1),1==this.scaleX&&this.frame%this.fireRate==0&&this.fire(),this.path&&this.frame*this.speed>=this.path.getTotalLength()&&this.loop&&(this.frame=0,this.firstRun=!1),this.frame++,this.ttl--}}function et(t){return new M(t)}class it extends M{init(t){t={name:"boss",spritesheet:[n["spritesheet16.png"],16,16],sprite:0,width:16,height:16,color:null,shield:10,debryColor:"white",fireRate:200,firing:!1,loop:!1,imune:!0,showStatus:!1,timers:[],...t};super.init(t),this.maxShield=this.shield}hit(t){super.hit(t),this.showStatus=!0,k(()=>{this.showStatus=!1},1e3)}fire(){this.firing=!0,this.imune=!1,this.timers[0]=k(()=>{N("boss-fire",this.x,this.y,this.rotation,3)},400),this.timers[1]=k(()=>{N("boss-fire",this.x,this.y,this.rotation,3)},800),this.timers[2]=k(()=>{N("boss-fire",this.x,this.y,this.rotation,3)},1200),k(()=>{this.firing=!1,this.imune=!0},1600)}die(){N("explosion",this.x,this.y,30,3,this.debryColor),N("score",10),this.ttl=0,this.timers.map(t=>clearTimeout(t)),N("boss-die")}update(){this.firing||super.update(),this.firing||(this.imune=!0)}draw(){var t,e;super.draw(),this.showStatus&&(t=this["context"],e=20*this.shield/this.maxShield,t.save(),t.translate(this.width/2,this.height/2),t.rotate(-this.rotation),t.fillStyle="white",t.fillRect(-12,-16,24,6),t.fillStyle="black",t.fillRect(-11,-15,22,4),t.fillStyle="green",this.shield<this.maxShield/4&&(t.fillStyle="red"),t.fillRect(-10,-14,e,2),t.restore())}}function st(t){return new it(t)}class ht extends i{init(t){t={name:"dialog",x:-16,y:200,sprites:[10,11,12,13,14],text:Y({text:"",x:16,y:8,align:"left"}),textIndex:0,texts:[],textsIndex:0,spriteIndex:0,frame:0,anchor:{x:0,y:0},talking:!1,isTalking:!1,stopping:!1,pauseOnTalk:!0,...t};super.init(t)}skip(){0==this.texts.length||this.textsIndex>this.texts.length||(this.textIndex=this.texts[this.textsIndex].length)}start(t){this.stopping=!1,setTimeout(()=>{this.isTalking=!0,this.texts=["",...t.texts],this.frame=0,this.pauseOnTalk=t.pauseOnTalk},1e3),this.dx=2}stop(){this.stopping=!0,this.text.text="        ",this.isTalking=!1,setTimeout(()=>{this.texts=[],this.textsIndex=0,this.textIndex=0,this.frame=0},1e3),this.dx=-2}update(){var t;8<this.x&&(this.dx=0,this.x=8),this.y<-16&&(this.dx=0,this.x=-16),0!=this.texts.length&&(this.talking=!1," "!==(t=this.texts[this.textsIndex]+"      ")[this.textIndex]&&(this.talking=!0),this.frame%5==0&&(this.textIndex++," "!==t[this.textIndex])&&G(D.typing),this.textsIndex<this.texts.length&&(this.text.text=t.slice(0,this.textIndex)),this.frame++,this.textIndex>=t.length&&(this.textsIndex++,this.frame=0,this.textIndex=0),this.textsIndex>=this.texts.length&&!this.stopping&&this.stop(),this.talking&&this.frame%5==0&&this.spriteIndex++,this.spriteIndex>=this.sprites.length&&(this.spriteIndex=0),super.update())}draw(){var{context:t,spritesheet:e}=this;t.fillStyle="white",t.fillRect(-2,-2,12,12),t.drawImage(e[0],8*this.sprites[this.spriteIndex],0,8,8,0,0,8,8),t.translate(16,0),this.text.draw()}}const rt=t=>new ht(t);function K(s,t){s.isAlive()&&t.forEach(t=>{var e,i;"enemy"===s.name&&"enemy"===t.name||t.isAlive()&&!s.imune&&!t.imune&&(i=s,e=x(e=t),i=x(i),e.x<i.x+i.width)&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.y+e.height>i.y&&("ship-bullet"!=s.name||t.imune||(s.ttl=0,t.hit(1)),"ship"!=s.name||"asteroid"!=t.name&&"boss"!=t.name||(s.die(),s.ttl=0,t.hit(5)),"ship"==s.name&&"enemy"==t.name&&(t.die(),t.ttl=0,s.hit(50)),"ship"==s.name&&"enemy-bullet"==t.name&&(t.ttl=0,s.hit(10)),"ship"!=s.name||"powerup"!=t.name||t.taken||(t.die(),s.powerUp(t)))})}class nt extends i{init(t){super.init({name:"powerup",type:"fire",width:16,height:16,taken:!1,anchor:{x:.5,y:.5},spritesheet:[n["font.png"],8,8],...t})}die(){this.taken=!0,this.ttl=10,this.frame=0}update(){248<this.y&&(this.ttl=0),super.update()}draw(){var{context:t,type:e,taken:i,frame:s}=this;let h,r;"shield"===e&&(h="yellow",r=18),"fire"===e&&(h="lightblue",r=15),t.strokeStyle=h,t.lineWidth=2,s%20<10&&!i&&t.strokeRect(0,0,16,16),t.fillStyle=h,t.fillRect(3,3,10,10),t.drawImage(this.spritesheet[0],8*r,0,8,8,4,4,8,8),i&&(t.globalAlpha=1-this.frame/10,t.strokeRect(-this.frame,-this.frame,16+2*this.frame,16+2*this.frame),t.globalAlpha=1)}}function at(t){return new nt(t)}const p={spiral:"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",zigzag:"M287 13-21 61l293 46-293 31 293 48-290 52",zigzagLeft:"m-21 13 308 48-293 46 293 31-293 48 291 52",zzLeft:"m20 7 50 48-48 46 48 31-48 48 48 52",zzRight:"m237 7-50 48 48 46-48 31 48 48-48 52",sandClock:"M121 123S-30 40 24 24C78 6 168 7 233 24 298 40-40 214 24 227c63 12 159 12 209 0 51-12-112-104-112-104Z",w:"M223-33v238c0 42-61 41-61 0V41c0-44-64-44-64 0v164c0 43-71 33-71 0V-27",wReversed:"M27-33v238c0 42 61 41 61 0V41c0-44 64-44 64 0v164c0 43 71 33 71 0V-27"};const f=[[{500:[3,400,4,!0,!0,1,0,200,p.sandClock],1e3:[3,400,5,!0,!0,2,0,200,p.sandClock]},{},{1500:["fire",128,.6]},{100:[!1,["CAPTAIN","    ","WE DETECTED SOME ENEMY SCOUTS","BETTER DESTROY THEM"]],1e3:[!1,["TOO LATE!","THEY ARE COMING","WITH A FULL FLEET","    ","GOOD LUCK!"]]},[]],[{1e3:[3,1e3,3,!0,!1,1,0,200,p.zigzag],2e3:[5,1500,6,!1,!1,1,0,130,p.zigzagLeft]},{},{2500:["fire",128,.6],550:["shield",140,.3]},{100:[!1,["TOO LATE!","THEY ARE COMING","WITH A FULL FLEET","    ","GOOD LUCK!"]]},[0,10,50,"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",30,8,9,1,20,150]],[{},{1e3:[13,1e3,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6],2500:["shield",140,.3],3500:["fire",128,.6]},{100:[!1,["13 ASTEROIDS DETECTED","      ","OOOPSS...","HOPE THIS DOES NOT TRIGGER","YOUR TRISKAIDEKAPHOBIA...","         "]]},[0,10,100,"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",40,4,9,1,60,50]],[{800:[5,400,9,!0,!1,4,0,400,p.zigzag],810:[5,400,9,!0,!1,4,0,400,p.zigzagLeft],2e3:[5,400,7,!0,!1,4,0,400,p.w],2010:[5,400,7,!0,!1,4,0,400,p.wReversed]},{},{1500:["fire",128,.6]},{100:[!1,["THAT CONDITION STILL","AFFECTING YOUR","VISION, HUH!?","         "]]},[0,10,250,p.sandClock,30,8,8,0,10,50]],[{2500:[13,200,5,!0,!0,1,0,50,p.spiral]},{1e3:[13,1e3,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6]},{100:[!1,["HERE COME MORE ASTEROIDS","12 PLUS 1, HEHE!","         ","ALSO 13 SHIPS","        ","OH MAN! NOT AGAIN!"]]},[]],[{500:[10,400,3,!1,!1,2,0,200,p.zzLeft],800:[10,400,4,!1,!1,2,0,200,p.zzRight],1500:[10,400,3,!1,!1,2,0,200,p.zzLeft],1800:[10,400,4,!1,!1,2,0,200,p.zzRight],2500:[5,1e3,6,!1,!1,1,0,40,p.spiral]},{},{1500:["fire",128,.6]},{100:[!1,["HMMM... ZIGZAGERS?","    "]]},[]],[{500:[3,400,4,!0,!0,1,0,200,p.sandClock],1e3:[3,400,5,!0,!0,2,0,200,p.sandClock]},{},{1500:["fire",128,.6]},{100:[!1,["CAPTAIN","    ","WE DETECTED SOME ENEMY SCOUTS","BETTER DESTROY THEM"]],1e3:[!1,["TOO LATE!","THEY ARE COMING","WITH A FULL FLEET","    ","GOOD LUCK!"]]},[]],[{1e3:[3,1e3,3,!0,!1,1,0,200,p.zigzag],2e3:[5,1500,6,!1,!1,1,0,130,p.zigzagLeft]},{},{2500:["fire",128,.6],550:["shield",140,.3]},{100:[!1,["TOO LATE!","THEY ARE COMING","WITH A FULL FLEET","    ","GOOD LUCK!"]]},[0,10,50,"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",30,8,9,1,20,150]],[{},{1e3:[13,1e3,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6],2500:["shield",140,.3],3500:["fire",128,.6]},{100:[!1,["13 ASTEROIDS DETECTED","      ","OOOPSS...","HOPE THIS DOES NOT TRIGGER","YOUR TRISKAIDEKAPHOBIA...","         "]]},[0,10,100,"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",40,4,9,1,60,50]],[{800:[5,400,9,!0,!1,4,0,400,p.zigzag],810:[5,400,9,!0,!1,4,0,400,p.zigzagLeft],2e3:[5,400,7,!0,!1,4,0,400,p.w],2010:[5,400,7,!0,!1,4,0,400,p.wReversed]},{},{1500:["fire",128,.6]},{100:[!1,["THAT CONDITION STILL","AFFECTING YOUR","VISION, HUH!?","         "]]},[0,10,250,p.sandClock,30,8,8,0,10,50]],[{2500:[13,200,5,!0,!0,1,0,50,p.spiral]},{1e3:[13,1e3,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6]},{100:[!1,["HERE COME MORE ASTEROIDS","12 PLUS 1, HEHE!","         ","ALSO 13 SHIPS","        ","OH MAN! NOT AGAIN!"]]},[]],[{500:[10,400,3,!1,!1,2,0,200,p.zzLeft],800:[10,400,4,!1,!1,2,0,200,p.zzRight],1500:[10,400,3,!1,!1,2,0,200,p.zzLeft],1800:[10,400,4,!1,!1,2,0,200,p.zzRight],2500:[5,1e3,6,!1,!1,1,0,40,p.spiral]},{},{1500:["fire",128,.6]},{100:[!1,["HMMM... ZIGZAGERS?","    "]]},[]]];function Z(t){var t=f[t],e=Math.max(...Object.keys(t[0]),...Object.keys(t[1]));let i=t[0][e];return e+=(i=i??t[1][e])[1]/1e3*60*i[0]}const ot=f.length;function lt(t=0,e=0,i=0,s=!1){var h,r=f[e],n=Z(e);r[0][t]&&N("spawn-enemy",(h=r[0][t])[0],h[1],{sprite:h[2],rotate:h[3],loop:h[4],shield:h[5],fireMode:h[6],fireRate:h[7],path:z(h[8])}),r[1][t]&&N("spawn-asteroid",...r[1][t]),r[2][t]&&N("spawn-powerup",...r[2][t]),r[3][t]&&N("set-dialog",...r[3][t]),0===r[4].length&&n<=t&&0===i&&N("next-level",e+1>=ot?0:e+1),0<r[4].length&&s&&0===i&&N("spawn-boss",...r[4])}const B={node:null,playing:!1,buffer:null,async set(t){var e=!!this.node;e&&await this.stop(),this.buffer=D[t],e&&await this.start()},async start(){this.node||(this.node=G(...this.buffer),this.node.loop=!0,await c.resume(),this.playing=!0)},async stop(){this.node&&(this.node.stop(),this.node.disconnect(),this.node=null,this.playing=!1)}};function dt(){U(["esc"],()=>{N("change-scene","menu")}),U(["p"],()=>{N("pause")}),U(["m"],()=>{B.playing?B.stop():B.start()}),q(["enter"]),U(["enter"],()=>i.skip()),B.set("song1"),B.start();const r=new Q({x:120,y:248}),e=W(20),i=rt(),s=rt();let h=0,n=0,a=3<n?Math.floor(.5*n):0,o=0,l=!0,d=!1,c=Z(h),p=!1,f;const u=V({create:$,maxSize:400}),x=V({create:j,maxSize:40}),g=V({create:j,maxSize:400}),m=V({create:tt,maxSize:10}),y=V({create:et,maxSize:50}),w=V({create:st,maxSize:4}),v=V({create:at,maxSize:4}),O=Y({text:"SCORE 00000",x:8,y:8}),E=Y({x:224,y:8,text:"@@@",color:"red"}),S=Y({x:128,y:120,text:"LEVEL 1",align:"center",color:"lightgreen"}),T=Y({x:248,y:224,text:"FIRE PODS :00",align:"right",color:"gray",ttl:0});var t=j({x:192,y:8,width:24,height:8,anchor:{x:0,y:0},draw(){var t=this["context"],e=0<=r.shield?r.shield/5:0;t.strokeStyle="white",t.lineWidth=2,t.strokeRect(0,0,this.width,this.height),t.fillStyle="green",r.shield<25&&(t.fillStyle="red"),t.fillRect(2,2,e,this.height-4)}});const b=j({x:0,y:0,active:!1,radius:384,update(){},update(){this.active&&60<this.radius&&(this.radius-=2),!this.active&&this.radius<384&&(this.radius+=1),this.advance()},draw(){var t=this["context"];t.save(),t.beginPath(),t.strokeStyle="white",t.lineWidth=3,t.arc(r.x,r.y,this.radius,0,2*Math.PI,!0),t.clip(),t.stroke()},start(){G(D.transition),this.radius=384,this.active=!0},end(){G(D.transition),this.active=!1},render(){this.draw()}});var A=j({x:0,y:0,update(){},draw(){var t=this["context"];t.restore()},render(){this.draw()}});H("hit",()=>{G(D.hit)}),H("explosion",(e,i,s,h,r)=>{G(D.explosion);for(let t=0;t<s;t++)t%2==0&&u.get({x:e,y:i,dx:_(-1,1)/2,dy:_(-1,1)/2,color:null,ttl:30}),u.get({x:e,y:i,dx:_(-h/2,h/2),dy:_(-h/2,h/2),color:r,ttl:30*h})}),H("ship-fire",(t,e,i)=>{G(D.shoot),x.get({name:"ship-bullet",x:t,y:e,width:2,height:4,dy:-4,dx:i,color:null,sprite:17,ttl:100,update(){this.advance(),this.y<0&&(this.ttl=0)}})}),H("ship-die",()=>{N("spawn-powerup","fire",128,.6)}),H("enemy-fire",(t,e)=>{G(D.shoot);var i=r.x-4-t,s=r.y-4-e,h=+Math.hypot(i,s);g.get({name:"enemy-bullet",x:t+4,y:e+4,dx:i/h,dy:s/h,width:2,height:2,color:"red",ttl:300})}),H("boss-fire",(e,i)=>{G(D.shoot2);for(let t=0;t<12;t++){var s=+Math.cos(L(30*t)),h=+Math.sin(L(30*t));g.get({name:"enemy-bullet",x:e,y:i,dx:s,dy:h,width:2,height:2,color:"red",ttl:400})}}),H("score",t=>{r.score+=Math.floor(t+2*a)}),H("spawn-boss",(t,e,i,s,h,r,n,a,o,l)=>{d=!1,N("spawn-enemy",r,0,{sprite:n,shield:2,fireRate:l,fireMode:a,parent:w.get({sprite:t,shield:e,fireRate:i,rotate:!1,loop:!0,imune:!0,debryColor:"pink",childrenSpeed:o,childrenRadius:h,path:z(s)}),path:null})}),H("spawn-enemy",(e,i,s)=>{e+=a;for(let t=0;t<e;t++){var h=t*(360/e);const r=C(1,2,s.sprite/4);k(t=>{y.get({...s,speed:r,anglePlacement:L(t),shield:s.shield+a})},t*i,h)}}),H("spawn-asteroid",(e,i,s,h,r)=>{13===e&&(b.start(),k(()=>b.end(),15e3));let n=0;for(let t=0;t<e;t++)n>s.length-1&&(n=0),k((t,e)=>{m.get({x:s[e],y:-8,dx:h[e],dy:r[e],shield:10+a})},t*i,t,n),n++}),H("spawn-powerup",(t,e,i)=>{"shield"===t&&p||v.get({type:t,x:e,y:-8,dy:i})}),H("set-dialog",(t,e)=>{t?s.start({texts:e,pauseOnTalk:!0}):i.start({texts:e,pauseOnTalk:!1})}),H("next-level",t=>{d=!1,h=t,n++,o=0,l=!1,c=Z(t),a=3<n?Math.floor(.25*n):0,N("score",100),12===n&&N("level-13"),25===n&&N("level-26")}),H("boss-die",()=>{N("score",200),N("next-level",h=++h>=ot?0:h)}),H("game-over",()=>{var t=localStorage.getItem("hiScore")||0;r.score>t&&localStorage.setItem("hiScore",r.score),N("change-scene","game-over",{score:r.score,previous:t})}),H("start-fire-timer",()=>{f=performance.now()+3e4,T.ttl=1/0}),H("end-fire-timer",()=>{f=null,T.ttl=0}),H("level-13",()=>{N("set-dialog",!0,["LETS MAKE THIS","INSTERESTING.","NOW WITH ONE LIFE ONLY"]),r.lives=1,r.shield=100}),H("level-26",()=>{N("set-dialog",!0,["HEY! YOU ARE GOOD AT THIS!","NOW ONE HIT AND YOU DIE!","AND NO SHIELD POWERUPS."]),r.lives=1,r.shield=10,p=!0});const I=X(),R=X(),M=X();return P({children:[b,e,x,g,r,y,w,m,v,u,A,i,s,t,S,O,E,T],gameOver:!1,update(){var t;this.paused=!1,s.isTalking&&s.pauseOnTalk?(s.update(),this.paused=!0):(o<40&&(S.text="LEVEL "+(n+1),S.ttl=100),T.text="PODS "+(f?Math.floor((f-performance.now())/1e3):"00"),t=y.size+m.size,o===c&&(d=!0),lt(o,h,t,d),r.lives<=0&&!this.gameOver?(this.gameOver=!0,k(()=>N("game-over"),1e3)):(x.getAliveObjects().forEach(t=>{I.clear(),I.add(t,m.getAliveObjects(),y.getAliveObjects(),w.getAliveObjects()),K(t,I.get(t))}),R.clear(),R.add(r,m.getAliveObjects(),y.getAliveObjects(),g.getAliveObjects(),w.getAliveObjects(),v.getAliveObjects()),K(r,R.get(r)),M.clear(),M.add(m.getAliveObjects()),m.getAliveObjects().forEach(t=>{K(t,M.get(t))}),O.text="SCORE "+r.score,E.text="@@@".slice(0,r.lives),l&&40<o&&o<140&&o%20==0&&e.decreaseVel(2),o++))}})}function ct(){U(["enter"],()=>{N("change-scene","game")}),q(["esc"]);const t=W(20),e=Y({x:128,y:32,text:"MICRO SHOOTER",align:"center",color:"red",scaleX:2,scaleY:4}),i=Y({x:128,y:88,text:"JS13K 2024 EDITION",align:"center",color:"yellow"}),s=Y({x:128,y:128,text:"A GAME BY\nMARCO FERNANDES",lineHeight:16,color:"white",align:"center"}),h=Y({x:128,y:176,text:"ARROWS OR WASD TO MOVE\nSPACE TO SHOOT",lineHeight:16,align:"center"});var r=Y({x:128,y:224,text:"ENTER TO START",color:"lightgreen",align:"center"});const n=P({frame:0,children:[t,r],update(){40<this.frame&&this.frame<140&&this.frame%20==0&&t.decreaseVel(2),this.frame++}});return k(()=>{n.add(e)},1e3),k(()=>{n.add(i)},2e3),k(()=>{n.add(s)},3e3),k(()=>{n.add(h)},4e3),n}var pt=(i,s,h,t=125)=>{let r,n,a,o,l,d,c,p,f,u,x,g,m,y,w=0,v=[],O=[],E=[],S=0,T=0,b=1,A={},I=F/t*60>>2;for(;b;S++)v=[b=p=g=0],h.map((t,e)=>{for(c=s[t][S]||[0,0,0],b|=!!s[t][S],y=g+(s[t][0].length-2-!p)*I,m=e==h.length-1,n=2,o=g;n<c.length+m;p=++n){for(l=c[n],f=n==c.length+m-1&&m||u!=(c[0]||0)|l|0,a=0;a<I&&p;a++>I-99&&f&&(x+=(x<1)/99))d=(1-x)*v[w++]/2||0,O[o]=(O[o]||0)-d*T+d,E[o]=(E[o++]||0)+d*T+d;l&&(x=l%1,T=c[1]||0,l|=0)&&(v=A[[u=c[w=0]||0,l]]=A[[u,l]]||((r=[...i[u]])[2]*=2**((l-12)/12),0<l?R(...r):[]))}g=y});return[O,E]},ft=[[[,0,77,,,.7,2,.41,,,,,,,,.06],[,0,43,.01,,.3,2,,,,,,,,,.02,.01],[,0,170,.003,,.008,,.97,-35,53,,,,,,.1],[.8,0,270,,,.12,3,1.65,-2,,,,,4.5,,.02],[,0,86,,,,,.7,,,,.5,,6.7,1,.05],[,0,41,,.05,.4,2,0,,,9,.01,,,,.08,.02],[,0,2200,,,.04,3,2,,,800,.02,,4.8,,.01,.1],[.3,0,16,,,.3,3]],[[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33],[3,1,22,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,24,,,,,,,,,,,,,,,,,,,,,,,,22,,22,,22,,,,],[5,-1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[,1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33],[3,1,24,,,,,,,,27,,,,,,,,,,,,,,,,27,,,,24,,,,24,,,,,,,,27,,,,,,,,,,,,,,,,24,,24,,24,,,,],[5,-1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[,1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[6,1,,,34,34,34,,,,,,34,34,,,,,34,,,,34,34,,,,,34,,,,34,,,,34,34,34,,,,,,34,,,,,,34,34,,,34,34,,,,,,,,,34,34],[4,1,,,,,,,24,,,,,,24,,24,,,,24,,,,24,,,,,,,,,,,,,,,,24,,,,,,24,,24,,,,24,,,,24,,,,,,,,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,23,23,35,23,23,36,23,23,35,23,23,36,23,23,35,35,23,23,35,23,23,35,23,23,36,23,23,35,23,23,36,36],[5,-1,21,,,19,,,21,,,,,,,,,,21,,,19,,,17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[3,1,24,,,24,,,24,,,,,,,,,,24,,,24,,,24,,,,24.75,24.5,24.26,24.01,24.01,24.01,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25],[4,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,24.75,24.5,24.26,24.01,24.01,24.01,24.01,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23,,21,23,,35,,23,,21,23,,35,,35,,23,,21,23,,35,,21,23,,35,,21,23,,,],[6,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,34,36,34,,33,34,34,36,31,36,34,,31,34,32,,33,36,34,,31,34,34,36,33,36,33,,31,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29],[4,1,24,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,21,,19,21,,33,,21,,19,21,,33,,33,,21,,19,21,,33,,21,,19,21,,33,,33,,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29],[2,1,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,,,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,,,],[6,1,,,36,,,,,,36,,36,,,,,,,,36,,,,,,36,,36,,,,,,,,36,,,,,,,,,,,,,,,,36,,,,,,36,,36,,,,,,],[3,1,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25,,,,,25,,,,,25,,,25,,,,,,,,25,,,,,,,,25,25,25,25]],[[1,-1,14,14,26,14,14,26,14,14,26,14,14,26,14,14,26,26,14,14,26,14,14,26,14,14,26,14,14,26,14,14,26,26,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29,19,19,31,19,19,31,19,19,31,19,19,31,19,19,31,31],[4,1,24,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,36,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,19,,19,19,31,19,19,31,19,,19,19,31,19,19,31],[2,1,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,,,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,,,],[3,1,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25],[6,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,34,,,,,,34,,34,,,,,,,,34,,,,,,34,,34,,,,,,]]],[0,1,1,2,3,4,4]],ut=[,,45,.03,.21,.6,4,.9,2,-3,,,,.2,,.9,,.45,.26],xt=[.9,,413,,.05,.01,1,3.8,-3,-13.4,,,,,,,.11,.65,.07,,237],gt=[1.5,,261,.01,.02,.08,1,1.5,-.5,,,-.5,,,,,.9,.05],mt=[1.6,,291,.01,.21,.35,,2.2,,,-136,.09,.03,,,.2,.2,.7,.28],yt=[,,468,.05,.62,.7,,.3,,,300,.05,.02,,,,.32,,.6],wt=[.8,,112,.03,.1,.2,3,3.6,18,-9,,,,,,,.03,.83,.12],vt=[2.3,,330,,.06,.17,2,3.7,,,,,.05,.4,2,.5,.13,.89,.05,.17],u=(u=document.getElementById("c").getContext("2d"),window.zyxplay=window.zyxplay||{},window.zyxplay.context=u);u.imageSmoothingEnabled=!1,u.setTransform(1,0,0,1,0,0),(async()=>{{let t;for(t=0;t<26;t++)d["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)d["Digit"+t]=d["Numpad"+t]=""+t;window.addEventListener("keydown",E),window.addEventListener("keyup",S)}function i(t,e){var i,s;switch(i=["change-scene"],s=Object.keys(r).reduce((t,e)=>(i.includes(e)&&(t[e]=r[e]),t),{}),r=s,B.stop(),t){case"game":h=dt();break;case"menu":h=ct();break;case"game-over":console.log("game-over",e),h=function({score:t=0,previous:e=localStorage.getItem("hiScore")||0}={}){U(["enter"],()=>{N("change-scene","menu")}),H("explosion",(e,i,s,h,r)=>{G(D.explosion);for(let t=0;t<s;t++)n.get({x:e,y:i,dx:_(-h/2,h/2),dy:_(-h/2,h/2),color:r,ttl:30*h})});var i=W(1);const n=V({create:$,maxSize:400}),s=Y({x:128,y:32,text:"GAME OVER",align:"center",color:"red",scaleX:2,scaleY:4}),h=Y({x:128,y:80,text:"YOUR SCORE:",color:"white",align:"center"}),r=Y({x:128,y:96,text:""+t,color:"white",align:"center",scaleX:2,scaleY:2}),a=Y({x:128,y:128,text:"NEW HIGH SCORE!",color:"yellow",align:"center"}),o=P({frame:0,children:[i,Y({x:128,y:224,text:"ENTER TO CONTINUE",color:"lightgreen",align:"center"}),n]});return k(()=>{o.add(s),N("explosion",128,48,100,6,"red")},1e3),k(()=>{o.add(h)},2e3),k(()=>{o.add(r)},2500),e<t&&k(()=>{o.add(a),N("explosion",128,132,60,4,"yellow")},3e3),o}(e)}}await t("song1",pt,ft),await t("explosion",R,ut),await t("shoot",R,xt),await t("shoot2",R,wt),await t("typing",R,gt),await t("powerup",R,mt),await t("hit",R,vt),await t("transition",R,yt),await e("font.png"),await e("spritesheet.png"),await e("spritesheet16.png"),H("change-scene",(t,e)=>i(t,e));let h=ct();(function({update:t,render:e}){let i=0,s,h,r;const n=o();function a(){if(requestAnimationFrame(a),h=performance.now(),r=h-s,s=h,!(1e3<r)){for(i+=r;i>=1e3/60;)t(1/60),i-=1e3/60;n.clearRect(0,0,n.canvas.width,n.canvas.height),e()}}return{start(){s=performance.now(),requestAnimationFrame(a)}}})({update(t){h.update(t)},render(){h.render()}}).start()})()}();