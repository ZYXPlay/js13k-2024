!function(){"use strict";function o(){return window.zyxplay.context}function X(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","path");return e.appendChild(i),i.setAttribute("d",t),i.setAttribute("fill","none"),i.setAttribute("stroke","black"),i.setAttribute("stroke-width","2"),i.setAttribute("id","path"),i}function L(t){return t*Math.PI/180}function R(t,e,i){return Math.min(Math.max(t,i),e)}function m(t){let{x:e=0,y:i=0,width:s,height:a}=t;return e-=.5*s,i-=.5*a,s<0&&(e+=s,s*=-1),a<0&&(i+=a,a*=-1),{x:e,y:i,width:s,height:a}}function T(t,e,...i){return setTimeout(t,e,...i)}function k(t=0,e=1){return Math.random()*(e-t)+t}let h={};function z(t,e){h[t]=h[t]||[],h[t].push(e)}function Z(t,...e){(h[t]||[]).map(t=>t(...e))}let d={},_={};function y(t,e){return new URL(t,e).href}function C(){window.__k||(window.__k={u:y,i:d,d:_})}function s(t,e,i){if(C(),_[t])return _[t];_[t]=e(...i)}function a(a,r=null){return C(),new Promise((t,e)=>{let i,s;return r?(d[a]=r,t(r)):d[a]?t(d[a]):((i=new Image).onload=()=>{s=y(a,window.location.href),d[s]=d[a]=i,t(i)},i.onerror=()=>{e()},void(i.src=a))})}class e{constructor(t){this.init(t)}init(t={}){t={name:"",x:0,y:0,width:8,height:8,rotation:0,scaleX:1,scaleY:1,anchor:{x:0,y:0},color:"white",dx:0,dy:0,ddx:0,ddy:0,ttl:1/0,frame:0,sprite:0,context:o(),spritesheet:[d["spritesheet.png"],8,8],shield:20,hitted:!1,_uf:t.update,_rf:t.render,_df:t.draw,...t};Object.assign(this,t)}hit(t){Z("hit"),this.shield-=t,this.hitted=!0,this.shield<=0&&this.die&&this.die(),T(()=>this.hitted=!1,100)}advance(){this.x+=this.dx,this.y+=this.dy,this.dx+=this.ddx,this.dy+=this.ddy,this.ttl--,this.frame++}update(){this._uf?this._uf():this.advance()}render(){if(this._rf)return this._rf();var{context:t,x:e,y:i,anchor:s,rotation:a,scaleX:r,scaleY:h,width:n,height:o}=this;t.save(),t.translate(e,i),a&&t.rotate(a),r&&h&&t.scale(r,h),t.translate(-n*s.x,-o*s.y),this.draw(),t.restore()}draw(){if(this._df)return this._df();var{context:t,color:e,width:i,height:s}=this;this.hitted&&(t.save(),t.translate(0,-1)),this.color?(t.fillStyle=e,t.fillRect(0,0,i,s)):t.drawImage(this.spritesheet[0],this.sprite*this.spritesheet[1],0,i,s,0,0,i,s),this.hitted&&(t.globalCompositeOperation="source-atop",t.fillStyle="white",t.fillRect(0,0,i,s),t.globalCompositeOperation="source-over",t.restore())}isAlive(){return 0<this.ttl}}const D=t=>new e(t);class v{constructor(t){this.init(t)}init(i={}){var t=Object.keys(i).reduce((t,e)=>("function"!=typeof i[e]&&(t[e]=i[e]),t),{}),t={id:"scene",context:o(),_uf:i.update,_rf:i.render,children:[],paused:!1,...t};Object.assign(this,t)}add(t){this.children.push(t)}pause(){this.paused=!0}resume(){this.paused=!1}update(e){this.paused||(this.children.forEach(t=>{if(!t.isAlive)return t.update(e);t.isAlive()&&t.update(e)}),this._uf&&this._uf())}render(){this.context.save(),this._uf&&this._uf(),this.children.forEach(t=>{if(!t.isAlive)return t.render();t.isAlive()&&t.render()}),this.context.restore()}}function N(t){return new v(t)}class H extends e{constructor(t={}){var t={name:"text",x:0,y:0,text:"",color:"white",align:"left",lineHeight:8,scale:1,spritesheet:d["font.png"],...t},e=t.color?`font-${t.color}.png`:"font.png";t.spritesheet=d[e],super(t)}draw(){var t=this.text.split("\n");const{context:r,align:e,lineHeight:h}=this;r.save(),t.forEach(i=>{r.save(),"center"===e&&r.translate(8*-i.length/2,0),"right"===e&&r.translate(8*-i.length,0);for(let e=0;e<i.length;e++){var s,a=i.charCodeAt(e);let t=64===a?41:58===a?40:33===a?39:63===a?38:44===a?37:46===a?36:32===a?-1:48<=a&&a<=57?a-22:65<=a&&a<=90?a-65:0;-1!==t&&(a=9*t,0,s=8*e,0,r.drawImage(this.spritesheet,a,0,9,9,s,0,9,9))}r.restore(),r.translate(0,h)}),r.restore()}}function j(t){return new H(t)}class S extends e{constructor(t){super({name:"explosion-particle",color:"white",anchor:{x:.5,y:.5},...t})}update(){!this.color&&this.ttl<30&&(this.scaleX=this.scaleY=this.ttl/30),this.color&&this.ttl<60&&(this.scaleX=this.scaleY=this.ttl/60),this.advance()}draw(){this.color||this.context.drawImage(this.spritesheet[0],120,0,8,8,0,0,8,8),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,2,2))}}function K(t){return new S(t)}let r={},n={},l={},c={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function b(t=()=>{},e){t._pd&&e.preventDefault(),t(e)}function E(t){var e=c[t.code],i=r[e];l[e]=!0,b(i,t)}function M(t){var e=c[t.code],i=n[e];l[e]=!1,b(i,t)}function t(t){return[].concat(t).some(t=>l[t])}function F(t,e,{handler:i="keydown",preventDefault:s=!0}={}){let a="keydown"==i?r:n;e._pd=s,[].concat(t).map(t=>a[t]=e)}function q(t,{handler:e="keydown"}={}){let i="keydown"==e?r:n;[].concat(t).map(t=>delete i[t])}const P=(...t)=>{let e=p.createBufferSource(),i=p.createBuffer(t.length,t[0].length,Y);return t.map((t,e)=>i.getChannelData(e).set(t)),e.buffer=i,e.connect(p.destination),e.start(),e},I=(t=1,e=.05,i=220,s=0,a=0,r=.1,h=0,n=1,o=0,l=0,d=0,c=0,p=0,g=0,f=0,u=0,x=0,w=1,m=0,y=0)=>{let C=2*Math.PI,v=o*=500*C/Y**2,H=(0<f?1:-1)*C/4,S=i*=(1+2*e*Math.random()-e)*C/Y,b=[],E=0,M=0,O=0,I=1,V=0,A=0,L=0,R,T;for(s=99+Y*s,m*=Y,a*=Y,r*=Y,x*=Y,l*=500*C/Y**3,f*=C/Y,d*=C/Y,c*=Y,p=Y*p|0,T=s+m+a+r+x|0;O<T;b[O++]=L)++A%(100*u|0)||(L=h?1<h?2<h?3<h?Math.sin((E%C)**3):Math.max(Math.min(Math.tan(E),1),-1):1-(2*E/C%2+2)%2:1-4*Math.abs(Math.round(E/C)-E/C):Math.sin(E),L=(p?1-y+y*Math.sin(2*Math.PI*O/p):1)*(0<L?1:-1)*Math.abs(L)**n*t*$*(O<s?O/s:O<s+m?1-(O-s)/m*(1-w):O<s+m+a?w:O<T-x?(T-O-x)/r*w:0),L=x?L/2+(x>O?0:(O<T-x?1:(T-O)/x)*b[O-x|0]/2):L),R=(i+=o+=l)*Math.sin(M*f-H),E+=R-R*g*(1-1e9*(Math.sin(O)+1)%2),M+=R-R*g*(1-1e9*(Math.sin(O)**2+1)%2),I&&++I>c&&(i+=d,S+=d,I=0),!p||++V%p||(i=S,o=v,I=I||1);return b},$=.3,Y=44100,p=new(window.AudioContext||webkitAudioContext),g=256,f=240;class J extends e{init(t){t={name:"ship",spawning:!0,y:248,spritesheet:[d["spritesheet16.png"],16,16],width:16,height:16,imune:!1,dying:!1,shield:100,lives:3,score:0,fireLevel:0,firing:!1,fireTimeout:null,anchor:{x:.5,y:.5},sprite:1,...t};super.init(t),this.spawn()}powerUp(t){P(_.powerup),"shield"===t.type&&(this.shield+=50,100<this.shield)&&(this.shield=100),"fire"===t.type&&(this.fireLevel++,4<this.fireLevel&&(this.fireLevel=4),4===this.fireLevel)&&(clearTimeout(this.fireTimeout),Z("start-fire-timer"),this.fireTimeout=T(()=>{Z("end-fire-timer"),4===this.fireLevel&&(this.fireLevel=3)},3e4))}fire(){this.firing||(this.firing=!0,Z("ship-fire",this.x-1,this.y-8,k(-.3,.3)),0<this.fireLevel&&Z("ship-fire",this.x-1,this.y-8,k(-.5,.5)),1<this.fireLevel&&T(()=>{Z("ship-fire",this.x-1,this.y-8,k(-.3,.3)),Z("ship-fire",this.x-1,this.y-8,k(-.5,.5))},100),2<this.fireLevel&&T(()=>{Z("ship-fire",this.x-1,this.y-8,-2),Z("ship-fire",this.x-1,this.y-8,2)},400),3<this.fireLevel&&T(()=>{Z("ship-fire",this.x-16,this.y-4,k(-.1,.1)),Z("ship-fire",this.x+14,this.y-4,k(-.1,.1))},200),T(()=>{this.firing=!1},200))}die(){Z("ship-die"),Z("explosion",this.x,this.y-4,60,4,"white",!0),this.dying=!0,this.ttl=0,this.lives--,this.imune=!0,this.dx=0,this.ddx=0,this.x=128,T(()=>{this.spawn()},1e3)}spawn(){this.imune=!0,this.spawning=!0,this.ttl=1/0,this.y=f-16,this.frame=0,this.shield=100,this.fireLevel=0,T(()=>{this.spawning=!1,this.imune=!1},1e3)}update(){this.ddx=0,this.ddy=0,this.dx*=.91,this.dy*=.91,this.sprite=2,t(["d","arrowright"])&&this.dx<3&&(this.ddx=.3,this.sprite=3),t(["a","arrowleft"])&&-3<this.dx&&(this.ddx=-.3,this.sprite=4),this.spawning||(t(["s","arrowdown"])&&this.dy<3&&(this.ddy=.3),t(["w","arrowup"])&&-3<this.dy&&(this.ddy=-.3)),!this.firing&&t("space")&&this.fire(),this.spawning&&(this.ddy=-.2,this.scaleX=this.scaleY=R(1,2,2-this.frame/60)),this.shield<=0&&this.die(),this.advance(),this.x<4&&(this.x=4,this.dx=0),this.x>g-4&&(this.x=g-4,this.dx=0),this.y<4&&(this.y=4,this.dy=0),this.y>f-4&&(this.y=f-4,this.dy=0)}draw(){var{context:t,width:e,height:i}=this;t.drawImage(this.spritesheet[0],this.spritesheet[1]*this.sprite,0,e,i,0,0,e,i);let s=1;this.ddy<0&&(s=this.frame%10<5?2:3),t.fillStyle="#FFaa33",t.fillRect(3,7,2,s),t.fillStyle="#FF6633",t.fillRect(this.frame%10<5?3:4,7+s,1,s),4===this.fireLevel&&(t.fillStyle="#FFF",t.fillRect(22,4,2,2),t.fillRect(-8,4,2,2)),this.hitted&&(t.globalCompositeOperation="source-atop",t.fillStyle="red",t.fillRect(0,0,e,i),t.globalCompositeOperation="source-over")}}class O{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t({id:""}))||!(i.update&&i.init&&i.isAlive&&i.render))throw Error("Must provide create() function which returns an object with init(), update(), render(), and isAlive() functions");this._c=t,this.objects=[t({id:""})],this.size=0,this.maxSize=e}get(t={}){if(this.size==this.objects.length){if(this.size==this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.push(this._c())}var e=this.objects[this.size];return this.size++,e.init(t),e}getAliveObjects(){return this.objects.slice(0,this.size)}clear(){this.size=this.objects.length=0,this.objects.push(this._c())}update(e){var i;let s=!1;for(let t=this.size;t--;)(i=this.objects[t]).update(e),i.isAlive()||(s=!0,this.size--);s&&this.objects.sort((t,e)=>e.isAlive()-t.isAlive())}render(){for(let t=this.size;t--;)this.objects[t].render()}}function U(t){return new O(t)}function G(e=1){var i=U({create:D,maxSize:480});i.increaseVel=function(e){this.objects.forEach(t=>{t.dy=t.dy*e})},i.decreaseVel=function(e){this.objects.forEach(t=>{t.dy=t.dy/e})},i.velocity=e;for(let t=-10;t<f;t++){var s=k(1,3)*e,a=Math.floor(s/e*50)+50;t%2==0&&i.get({x:Math.floor(k(0,g)),y:t,width:1,height:1+s/4,dy:s/4,color:`rgb(${a}, ${a}, ${a})`,update(){this.advance(),this.y>f&&(this.y=-10),this.height=1+this.dy/4}})}return i.isAlive=()=>!0,i}class V extends e{init(t){t={name:"asteroid",spritesheet:[d["spritesheet16.png"],16,16],sprite:1,width:16,height:16,color:null,anchor:{x:.5,y:.5},shield:10,...t};super.init(t)}die(){Z("explosion",this.x,this.y,50,4,"white"),Z("score",10),this.ttl=0}update(){this.rotation=this.frame/(10/this.dy),this.advance(),this.x<0||this.x>g+8||this.y>f+8&&(this.ttl=0)}}function Q(t){return new V(t)}function A(t,e){var i=[],s=e.x+e.width/2,e=e.y+e.height/2,a=t.y<e,e=t.y+t.height>=e;return t.x<s&&(a&&i.push(0),e)&&i.push(2),t.x+t.width>=s&&(a&&i.push(1),e)&&i.push(3),i}class t1{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;t=o().canvas;this.bounds=i||{x:0,y:0,width:t.width,height:t.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map(t=>{t.clear()}),this._b=!1,this._o.length=0}get(e){let i=new Set;return this._s.length&&this._b?(A(e,this.bounds).map(t=>{this._s[t].get(e).map(t=>i.add(t))}),Array.from(i)):this._o.filter(t=>t!==e)}add(...t){t.flat().map(t=>{this._b?this._a(t):(this._o.push(t),this._o.length>this.maxObjects&&this._d<this.maxDepth&&(this._sp(),this._o.map(t=>this._a(t)),this._o.length=0))})}_a(e){A(e,this.bounds).map(t=>{this._s[t].add(e)})}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,i=0;i<4;i++)this._s[i]=new t1({bounds:{x:this.bounds.x+(i%2==1?t:0),y:this.bounds.y+(2<=i?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1}}function W(t){return new t1(t)}class e1 extends e{init(t){t={name:"enemy",sprite:3,color:null,anchor:{x:.5,y:.5},shield:1,frame:0,loop:!0,firstRun:!0,debryColor:"white",fireRate:200,speed:1,...t};super.init(t),this.path&&(this.ttl=Math.floor(t.path.getTotalLength()/this.speed)),this.loop&&(this.ttl=1/0)}fire(){Z("enemy-fire",this.x-4,this.y-4,this.rotation,3)}die(){Z("explosion",this.x,this.y,20,3,this.debryColor),Z("score",10),this.ttl=0}update(){var t,e;this.rotation=L(180),this.path?(t=this.path.getPointAtLength(this.frame*this.speed),e=this.path.getPointAtLength(this.frame*this.speed+1),this.x=Math.floor(t.x),this.y=Math.floor(t.y),this.rotate&&(this.rotation=L(90)+Math.atan2(e.y-t.y,e.x-t.x))):(this.x=this.parent.x+Math.cos(this.frame/this.parent.childrenSpeed+this.anglePlacement)*this.parent.childrenRadius,this.y=this.parent.y+Math.sin(this.frame/this.parent.childrenSpeed+this.anglePlacement)*this.parent.childrenRadius),this.firstRun&&(this.scaleX=this.scaleY=R(0,1,(this.frame*this.speed+1)/100)),!this.loop&&this.ttl<100&&(this.scaleX=this.scaleY=R(0,1,this.ttl/100)),this.scaleX<1&&(this.imune=!0),1<=this.scaleX&&(this.imune=!1),1==this.scaleX&&this.frame%this.fireRate==0&&this.fire(),this.path&&this.frame*this.speed>=this.path.getTotalLength()&&this.loop&&(this.frame=0,this.firstRun=!1),this.frame++,this.ttl--}}function i1(t){return new e1(t)}class s1 extends e1{init(t){t={name:"boss",spritesheet:[d["spritesheet16.png"],16,16],sprite:0,width:16,height:16,color:null,shield:10,debryColor:"white",fireRate:200,firing:!1,loop:!1,imune:!0,showStatus:!1,timers:[],...t};super.init(t),this.maxShield=this.shield}hit(t){super.hit(t),this.showStatus=!0,T(()=>{this.showStatus=!1},1e3)}fire(){this.firing=!0,this.imune=!1,this.timers[0]=T(()=>{Z("boss-fire",this.x,this.y,this.rotation,3)},400),this.timers[1]=T(()=>{Z("boss-fire",this.x,this.y,this.rotation,3)},800),this.timers[2]=T(()=>{Z("boss-fire",this.x,this.y,this.rotation,3)},1200),T(()=>{this.firing=!1,this.imune=!0},1600)}die(){Z("explosion",this.x,this.y,70,6,this.debryColor,!0),Z("score",10),this.ttl=0,this.timers.map(t=>clearTimeout(t)),Z("boss-die")}update(){this.firing||super.update(),this.firing||(this.imune=!0)}draw(){var t,e;super.draw(),this.showStatus&&(t=this["context"],e=20*this.shield/this.maxShield,t.save(),t.translate(this.width/2,this.height/2),t.rotate(-this.rotation),t.fillStyle="white",t.fillRect(-12,-16,24,6),t.fillStyle="black",t.fillRect(-11,-15,22,4),t.fillStyle="green",this.shield<this.maxShield/4&&(t.fillStyle="red"),t.fillRect(-10,-14,e,2),t.restore())}}function a1(t){return new s1(t)}class r1 extends e{init(t){t={name:"dialog",x:-16,y:200,sprites:[10,11,12,13,14],text:j({text:"",x:16,y:8,align:"left"}),textIndex:0,texts:[],textsIndex:0,spriteIndex:0,frame:0,anchor:{x:0,y:0},talking:!1,isTalking:!1,stopping:!1,pauseOnTalk:!0,...t};super.init(t)}skip(){0==this.texts.length||this.textsIndex>this.texts.length||(this.textIndex=this.texts[this.textsIndex].length)}start(t){this.stopping=!1,setTimeout(()=>{this.isTalking=!0,this.texts=["",...t.texts],this.frame=0,this.pauseOnTalk=t.pauseOnTalk},1e3),this.dx=2}stop(){this.stopping=!0,this.text.text="        ",this.isTalking=!1,setTimeout(()=>{this.texts=[],this.textsIndex=0,this.textIndex=0,this.frame=0},1e3),this.dx=-2}update(){var t;8<this.x&&(this.dx=0,this.x=8),this.y<-16&&(this.dx=0,this.x=-16),0!=this.texts.length&&(this.talking=!1," "!==(t=this.texts[this.textsIndex]+"      ")[this.textIndex]&&(this.talking=!0),this.frame%5==0&&(this.textIndex++," "!==t[this.textIndex])&&P(_.typing),this.textsIndex<this.texts.length&&(this.text.text=t.slice(0,this.textIndex)),this.frame++,this.textIndex>=t.length&&(this.textsIndex++,this.frame=0,this.textIndex=0),this.textsIndex>=this.texts.length&&!this.stopping&&this.stop(),this.talking&&this.frame%5==0&&this.spriteIndex++,this.spriteIndex>=this.sprites.length&&(this.spriteIndex=0),super.update())}draw(){var{context:t,spritesheet:e}=this;t.fillStyle="white",t.fillRect(-2,-2,12,12),t.drawImage(e[0],8*this.sprites[this.spriteIndex],0,8,8,0,0,8,8),t.translate(16,0),this.text.draw()}}const h1=t=>new r1(t);function B(s,t){s.isAlive()&&t.forEach(t=>{var e,i;"enemy"===s.name&&"enemy"===t.name||t.isAlive()&&!s.imune&&!t.imune&&(i=s,e=m(e=t),i=m(i),e.x<i.x+i.width)&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.y+e.height>i.y&&("ship-bullet"!=s.name||t.imune||(s.ttl=0,t.hit(1)),"ship"!=s.name||"asteroid"!=t.name&&"boss"!=t.name||(s.die(),s.ttl=0,t.hit(5)),"ship"==s.name&&"enemy"==t.name&&(t.die(),t.ttl=0,s.hit(50)),"ship"==s.name&&"enemy-bullet"==t.name&&(t.ttl=0,s.hit(10)),"ship"!=s.name||"powerup"!=t.name||t.taken||(t.die(),s.powerUp(t)))})}class n1 extends e{init(t){super.init({name:"powerup",type:"fire",width:16,height:16,taken:!1,anchor:{x:.5,y:.5},spritesheet:[d["font-white.png"],8,8],...t})}die(){this.taken=!0,this.ttl=10,this.frame=0}update(){248<this.y&&(this.ttl=0),super.update()}draw(){var{context:t,type:e,taken:i,frame:s}=this;let a,r;"shield"===e&&(a="yellow",r=18),"fire"===e&&(a="lightblue",r=15),t.strokeStyle=a,t.lineWidth=2,s%20<10&&!i&&t.strokeRect(0,0,16,16),t.fillStyle=a,t.fillRect(3,3,10,10),t.drawImage(this.spritesheet[0],8*r,0,8,8,4,4,8,8),i&&(t.globalAlpha=1-this.frame/10,t.strokeRect(-this.frame,-this.frame,16+2*this.frame,16+2*this.frame),t.globalAlpha=1)}}function o1(t){return new n1(t)}const i={spiral:"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",zigzag:"M287 13-21 61l293 46-293 31 293 48-290 52",zigzagLeft:"m-21 13 308 48-293 46 293 31-293 48 291 52",zzLeft:"m20 7 50 48-48 46 48 31-48 48 48 52",zzRight:"m237 7-50 48 48 46-48 31 48 48-48 52",sandClock:"M121 123S-30 40 24 24C78 6 168 7 233 24 298 40-40 214 24 227c63 12 159 12 209 0 51-12-112-104-112-104Z",w:"M223-33v238c0 42-61 41-61 0V41c0-44-64-44-64 0v164c0 43-71 33-71 0V-27",wReversed:"M27-33v238c0 42 61 41 61 0V41c0-44 64-44 64 0v164c0 43 71 33 71 0V-27"};const l1=[[{500:[3,400,4,!0,!0,1,0,200,i.sandClock],1e3:[3,400,5,!0,!0,2,0,200,i.sandClock]},{},{1500:["fire",128,.6]},{100:[!1,["CAPTAIN","    ","WE DETECTED SOME ENEMY SCOUTS","BETTER DESTROY THEM"]],1e3:[!1,["TOO LATE!","THEY ARE COMING","WITH A FULL FLEET","    ","GOOD LUCK!"]]},[]],[{1e3:[3,1e3,3,!0,!1,1,0,200,i.zigzag],2e3:[5,1500,6,!1,!1,1,0,130,i.zigzagLeft]},{},{2500:["fire",128,.6],550:["shield",140,.3]},{100:[!1,["TOO LATE!","THEY ARE COMING","WITH A FULL FLEET","    ","GOOD LUCK!"]]},[0,10,50,"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",30,8,9,1,20,150]],[{},{1e3:[13,1e3,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6],2500:["shield",140,.3],3500:["fire",128,.6]},{100:[!1,["13 ASTEROIDS DETECTED","      ","OOOPSS...","HOPE THIS DOES NOT TRIGGER","YOUR TRISKAIDEKAPHOBIA...","         "]]},[0,10,100,"M127 120V43c0-77 99 8 99 77 0 70-35 102-99 102S22 181 22 120s32-84 84-84 85 32 85 84c0 53-28 62-64 62-35 0-68-18-68-62 0-43 25-47 47-47 21 0 48 24 48 47 0 24-7 28-27 28s0-14 0-28Z",40,4,9,1,60,50]],[{800:[5,400,9,!0,!1,4,0,400,i.zigzag],810:[5,400,9,!0,!1,4,0,400,i.zigzagLeft],2e3:[5,400,7,!0,!1,4,0,400,i.w],2010:[5,400,7,!0,!1,4,0,400,i.wReversed]},{},{1500:["fire",128,.6]},{100:[!1,["THAT CONDITION STILL","AFFECTING YOUR","VISION, HUH!?","         "]]},[0,10,250,i.sandClock,30,8,8,0,10,50]],[{2500:[14,200,5,!0,!0,1,0,50,i.spiral]},{1e3:[13,1e3,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6]},{100:[!1,["HERE COME MORE ASTEROIDS","12 PLUS 1, HEHE!","         ","ALSO 13 SHIPS","        ","OH MAN! NOT AGAIN!"]]},[]],[{500:[10,400,3,!1,!1,2,0,200,i.zzLeft],800:[10,400,4,!1,!1,2,0,200,i.zzRight],1500:[10,400,3,!1,!1,2,0,200,i.zzLeft],1800:[10,400,4,!1,!1,2,0,200,i.zzRight],2500:[5,1e3,6,!1,!1,1,0,40,i.spiral]},{},{1500:["fire",128,.6]},{100:[!1,["HMMM... ZIGZAGERS?","    "]]},[]],[{500:[3,400,4,!0,!1,4,1,100,i.spiral],2e3:[3,1e3,5,!0,!1,4,1,100,i.sandClock]},{500:[30,700,[220,180,40,120,60,20,200,120,180,60],[-.1,0,.1,0,.1,0,-.1,0,-.1,.1],[.5,1,.8,.4,.7,1,.5,.7,.5,.9]]},{1500:["shield",128,.6],500:["fire",64,.3]},{},[0,60,150,i.sandClock,30,16,8,1,100,50]],[{500:[5,1e3,9,!0,!1,1,0,100,i.w],501:[5,1e3,9,!0,!1,1,0,100,i.wReversed],1500:[5,1e3,3,!1,!1,1,0,100,i.zzLeft],1501:[5,1e3,3,!1,!1,1,0,100,i.zzRight]},{},{2500:["fire",128,.6],550:["shield",140,.3]},{100:[!1,["THEY JUST KEEP COMING"]]},[]],[{500:[1,1e3,9,!0,!1,10,0,30,i.spiral]},{},{1500:["fire",128,.6],2500:["shield",140,.3],3500:["fire",128,.6]},{},[0,20,110,i.spiral,100,8,9,1,60,100]],[{1200:[13,400,9,!0,!1,4,0,400,i.zigzag],3500:[20,400,9,!0,!1,1,0,1e3,i.spiral]},{2e3:[30,700,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6]},{100:[!1,["HMMM... DETECTING A SHIP","WITH SOME TAG ON IT...","A NUMBER, MAYBE?","YEP, IT IS 13","YIKES! I AM SORRY..."]]},[0,30,150,i.sandClock,30,8,8,0,100,500]],[{2500:[13,200,5,!0,!0,1,0,50,i.spiral]},{10:[60,400,[20,200,120,180,60,220,180,40,120,60],[0,-.1,0,-.1,.1,-.1,0,.1,0,.1],[1,.5,.7,.5,.9,.5,1,.8,.4,.7]]},{1500:["fire",128,.6]},{3e3:[!1,["CONTROL YOURSELF, CAPTAIN!"]]},[]],[{1500:[10,400,3,!1,!1,2,0,200,i.zzLeft],1800:[10,400,4,!1,!1,2,0,200,i.zzRight],2500:[5,1e3,6,!1,!1,1,0,40,i.spiral]},{},{1500:["fire",64,.6],1500:["shield",156,.4]},{100:[!1,["I GOT A FEELING","THIS NEVER ENDS","       ","MAYBE THAT IS WHY","IT IS A GAME.","       ","OH WELL, LETS KEEP GOING.","BUT HARDER THIS TIME. HEHE!"]]},[]]];function d1(t){var t=l1[t],e=Math.max(...Object.keys(t[0]),...Object.keys(t[1]));let i=t[0][e];return e+=(i=i??t[1][e])[1]/1e3*60*i[0]}const c1=l1.length;function p1(t=0,e=0,i=0,s=!1){var a,r=l1[e],h=d1(e);r[0][t]&&Z("spawn-enemy",(a=r[0][t])[0],a[1],{sprite:a[2],rotate:a[3],loop:a[4],shield:a[5],fireMode:a[6],fireRate:a[7],path:X(a[8])}),r[1][t]&&Z("spawn-asteroid",...r[1][t]),r[2][t]&&Z("spawn-powerup",...r[2][t]),r[3][t]&&Z("set-dialog",...r[3][t]),0===r[4].length&&h<=t&&0===i&&Z("next-level",e+1>=c1?0:e+1),0<r[4].length&&s&&0===i&&Z("spawn-boss",...r[4])}const g1={node:null,playing:!1,buffer:null,async set(t){var e=!!this.node;e&&await this.stop(),this.buffer=_[t],e&&await this.start()},async start(){this.node||(this.node=P(...this.buffer),this.node.loop=!0,await p.resume(),this.playing=!0)},async stop(){this.node&&(this.node.stop(),this.node.disconnect(),this.node=null,this.playing=!1)}};function f1(){F(["esc"],()=>{Z("change-scene","menu")}),F(["p"],()=>{Z("pause")}),F(["m"],()=>{g1.playing?g1.stop():g1.start()}),q(["enter"]),F(["enter"],()=>i.skip());const r=new J({x:120,y:248}),e=G(20),i=h1(),s=h1();let a=0,h=0,n=12<h?Math.floor(.25*h):0,o=0,l=!0,d=!1,c=d1(a),p=!1,g;const f=U({create:K,maxSize:400}),u=U({create:D,maxSize:40}),x=U({create:D,maxSize:400}),w=U({create:Q,maxSize:10}),m=U({create:i1,maxSize:50}),y=U({create:a1,maxSize:4}),C=U({create:o1,maxSize:4}),v=j({text:"SCORE 00000",x:8,y:8});var t=j({text:"HI "+(localStorage.getItem("hiScore")||0),x:128,y:8,color:"gray",align:"center"});const H=j({x:224,y:8,text:"@@@",color:"red"});var S=j({x:128,y:120,text:"LEVEL 1",align:"center",color:"lightgreen",ttl:0});const b=j({x:248,y:224,text:"FIRE PODS :00",align:"right",color:"gray",ttl:0});var E=D({x:192,y:8,width:24,height:8,anchor:{x:0,y:0},draw(){var t=this["context"],e=0<=r.shield?r.shield/5:0;t.strokeStyle="white",t.lineWidth=2,t.strokeRect(0,0,this.width,this.height),t.fillStyle="green",r.shield<25&&(t.fillStyle="red"),t.fillRect(2,2,e,this.height-4)}});const M=D({x:0,y:0,active:!1,radius:484,update(){},update(){this.active&&60<this.radius&&(this.radius-=2),!this.active&&this.radius<484&&(this.radius+=1),this.advance()},draw(){var t=this["context"];t.save(),t.beginPath(),t.strokeStyle="white",t.lineWidth=3,t.arc(r.x,r.y,this.radius,0,2*Math.PI,!0),t.clip(),t.stroke()},start(){P(_.transition),this.radius=484,this.active=!0},end(){P(_.transition),this.active=!1},render(){this.draw()}});var O=D({x:0,y:0,update(){},draw(){var t=this["context"];t.restore()},render(){this.draw()}});z("hit",()=>{P(_.hit)}),z("explosion",(e,i,s,a,r,t=!1)=>{t=t?"bigExplosion":"explosion";P(_[t]);for(let t=0;t<s;t++)t%2==0&&f.get({x:e,y:i,dx:k(-1,1)/2,dy:k(-1,1)/2,color:null,ttl:30}),f.get({x:e,y:i,dx:k(-a/2,a/2),dy:k(-a/2,a/2),color:r,ttl:30*a})}),z("ship-fire",(t,e,i)=>{P(_.shoot),u.get({name:"ship-bullet",x:t,y:e,width:2,height:4,dy:-4,dx:i,color:null,sprite:16,ttl:100,update(){this.advance(),this.y<0&&(this.ttl=0)}})}),z("ship-die",()=>{Z("spawn-powerup","fire",128,.6)}),z("enemy-fire",(t,e)=>{P(_.shoot);var i=r.x-4-t,s=r.y-4-e,a=+Math.hypot(i,s);x.get({name:"enemy-bullet",x:t+4,y:e+4,dx:i/a,dy:s/a,width:3,height:3,color:"red",ttl:300,draw(){var t=this["context"];t.fillStyle=this.color,t.fillRect(0,0,this.width,this.height),t.fillStyle="white",t.fillRect(1,1,1,1)}})}),z("boss-fire",(e,i)=>{P(_.shoot2);for(let t=0;t<12;t++){var s=+Math.cos(L(30*t)),a=+Math.sin(L(30*t));x.get({name:"enemy-bullet",x:e,y:i,dx:s,dy:a,width:3,height:3,color:"red",ttl:400})}}),z("score",t=>{r.score+=Math.floor(t+2*n)}),z("spawn-boss",(t,e,i,s,a,r,h,n,o,l)=>{d=!1,Z("spawn-enemy",r,0,{sprite:h,shield:2,fireRate:l,fireMode:n,parent:y.get({sprite:t,shield:e,fireRate:i,rotate:!1,loop:!0,imune:!0,debryColor:"pink",childrenSpeed:o,childrenRadius:a,path:X(s)}),path:null})}),z("spawn-enemy",(e,i,s)=>{13===e&&(M.start(),T(()=>M.end(),15e3)),e+=n;for(let t=0;t<e;t++){var a=t*(360/e);const r=R(1,2,s.sprite/4);T(t=>{m.get({...s,speed:r,anglePlacement:L(t),shield:s.shield+n})},t*i,a)}}),z("spawn-asteroid",(e,i,s,a,r)=>{13===e&&(M.start(),T(()=>M.end(),15e3));let h=0;for(let t=0;t<e;t++)h>s.length-1&&(h=0),T((t,e)=>{w.get({x:s[e],y:-8,dx:a[e],dy:r[e],shield:10+n})},t*i,t,h),h++}),z("spawn-powerup",(t,e,i)=>{"shield"===t&&p||C.get({type:t,x:e,y:-8,dy:i})}),z("set-dialog",(t,e)=>{t?s.start({texts:e,pauseOnTalk:!0}):i.start({texts:e,pauseOnTalk:!1})}),z("next-level",t=>{d=!1,a=t,h++,o=0,l=!1,c=d1(t),n=12<h?Math.floor(.25*h):0,Z("score",100),12===h&&Z("level-13"),25===h&&Z("level-26")}),z("boss-die",()=>{Z("score",200),Z("next-level",a=++a>=c1?0:a)}),z("game-over",()=>{var t=localStorage.getItem("hiScore")||0;r.score>t&&localStorage.setItem("hiScore",r.score),Z("change-scene","game-over",{score:r.score,previous:t})}),z("start-fire-timer",()=>{g=performance.now()+3e4,b.ttl=1/0}),z("end-fire-timer",()=>{g=null,b.ttl=0}),z("level-13",()=>{Z("set-dialog",!0,["LETS MAKE THIS","INSTERESTING.","NOW WITH ONE LIFE ONLY"]),r.lives=1,r.shield=100}),z("level-26",()=>{Z("set-dialog",!0,["HEY! YOU ARE GOOD AT THIS!","NOW ONE HIT AND YOU DIE!","AND NO SHIELD POWERUPS."]),r.lives=1,r.shield=10,p=!0});const I=W(),V=W(),A=W();return N({children:[M,e,u,x,r,m,y,w,C,f,O,i,s,E,S,v,t,H,b],gameOver:!1,update(){var t;this.paused=!1,s.isTalking&&s.pauseOnTalk?(s.update(),this.paused=!0):(b.text="PODS "+(g?Math.floor((g-performance.now())/1e3):"00"),t=m.size+w.size,o===c&&(d=!0),p1(o,a,t,d),r.lives<=0&&!this.gameOver?(this.gameOver=!0,T(()=>Z("game-over"),1e3)):(u.getAliveObjects().forEach(t=>{I.clear(),I.add(t,w.getAliveObjects(),m.getAliveObjects(),y.getAliveObjects()),B(t,I.get(t))}),V.clear(),V.add(r,w.getAliveObjects(),m.getAliveObjects(),x.getAliveObjects(),y.getAliveObjects(),C.getAliveObjects()),B(r,V.get(r)),A.clear(),A.add(w.getAliveObjects()),w.getAliveObjects().forEach(t=>{B(t,A.get(t))}),v.text="SCORE "+r.score,H.text="@@@".slice(0,r.lives),l&&40<o&&o<140&&o%20==0&&e.decreaseVel(2),l&&0===o&&P(_.engineSlowdown),o++))}})}var u1=(i,s,a,t=125)=>{let r,h,n,o,l,d,c,p,g,f,u,x,w,m,y=0,C=[],v=[],H=[],S=0,b=0,E=1,M={},O=Y/t*60>>2;for(;E;S++)C=[E=p=x=0],a.map((t,e)=>{for(c=s[t][S]||[0,0,0],E|=!!s[t][S],m=x+(s[t][0].length-2-!p)*O,w=e==a.length-1,h=2,o=x;h<c.length+w;p=++h){for(l=c[h],g=h==c.length+w-1&&w||f!=(c[0]||0)|l|0,n=0;n<O&&p;n++>O-99&&g&&(u+=(u<1)/99))d=(1-u)*C[y++]/2||0,v[o]=(v[o]||0)-d*b+d,H[o]=(H[o++]||0)+d*b+d;l&&(u=l%1,b=c[1]||0,l|=0)&&(C=M[[f=c[y=0]||0,l]]=M[[f,l]]||((r=[...i[f]])[2]*=2**((l-12)/12),0<l?I(...r):[]))}x=m});return[v,H]},x1=[[[,0,77,,,.7,2,.41,,,,,,,,.06],[,0,43,.01,,.3,2,,,,,,,,,.02,.01],[,0,170,.003,,.008,,.97,-35,53,,,,,,.1],[.8,0,270,,,.12,3,1.65,-2,,,,,4.5,,.02],[,0,86,,,,,.7,,,,.5,,6.7,1,.05],[,0,41,,.05,.4,2,0,,,9,.01,,,,.08,.02],[,0,2200,,,.04,3,2,,,800,.02,,4.8,,.01,.1],[.3,0,16,,,.3,3]],[[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33],[3,1,22,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,24,,,,,,,,,,,,,,,,,,,,,,,,22,,22,,22,,,,],[5,-1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[,1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33],[3,1,24,,,,,,,,27,,,,,,,,,,,,,,,,27,,,,24,,,,24,,,,,,,,27,,,,,,,,,,,,,,,,24,,24,,24,,,,],[5,-1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[,1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[6,1,,,34,34,34,,,,,,34,34,,,,,34,,,,34,34,,,,,34,,,,34,,,,34,34,34,,,,,,34,,,,,,34,34,,,34,34,,,,,,,,,34,34],[4,1,,,,,,,24,,,,,,24,,24,,,,24,,,,24,,,,,,,,,,,,,,,,24,,,,,,24,,24,,,,24,,,,24,,,,,,,,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,23,23,35,23,23,36,23,23,35,23,23,36,23,23,35,35,23,23,35,23,23,35,23,23,36,23,23,35,23,23,36,36],[5,-1,21,,,19,,,21,,,,,,,,,,21,,,19,,,17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[3,1,24,,,24,,,24,,,,,,,,,,24,,,24,,,24,,,,24.75,24.5,24.26,24.01,24.01,24.01,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25],[4,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,24.75,24.5,24.26,24.01,24.01,24.01,24.01,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23,,21,23,,35,,23,,21,23,,35,,35,,23,,21,23,,35,,21,23,,35,,21,23,,,],[6,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,34,36,34,,33,34,34,36,31,36,34,,31,34,32,,33,36,34,,31,34,34,36,33,36,33,,31,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29],[4,1,24,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,21,,19,21,,33,,21,,19,21,,33,,33,,21,,19,21,,33,,21,,19,21,,33,,33,,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29],[2,1,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,,,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,,,],[6,1,,,36,,,,,,36,,36,,,,,,,,36,,,,,,36,,36,,,,,,,,36,,,,,,,,,,,,,,,,36,,,,,,36,,36,,,,,,],[3,1,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25,,,,,25,,,,,25,,,25,,,,,,,,25,,,,,,,,25,25,25,25]],[[1,-1,14,14,26,14,14,26,14,14,26,14,14,26,14,14,26,26,14,14,26,14,14,26,14,14,26,14,14,26,14,14,26,26,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29,19,19,31,19,19,31,19,19,31,19,19,31,19,19,31,31],[4,1,24,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,36,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,19,,19,19,31,19,19,31,19,,19,19,31,19,19,31],[2,1,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,,,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,,,],[3,1,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25],[6,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,34,,,,,,34,,34,,,,,,,,34,,,,,,34,,34,,,,,,]]],[0,1,1,2,3,4,4]],w1=[,,45,.03,.21,.6,4,.9,2,-3,,,,.2,,.9,,.45,.26],m1=[.9,,413,,.05,.01,1,3.8,-3,-13.4,,,,,,,.11,.65,.07,,237],y1=[1.5,,261,.01,.02,.08,1,1.5,-.5,,,-.5,,,,,.9,.05],C1=[1.6,,291,.01,.21,.35,,2.2,,,-136,.09,.03,,,.2,.2,.7,.28],v1=[,,468,.05,.62,.7,,.3,,,300,.05,.02,,,,.32,,.6],H1=[.8,,112,.03,.1,.2,3,3.6,18,-9,,,,,,,.03,.83,.12],S1=[2.3,,330,,.06,.17,2,3.7,,,,,.05,.4,2,.5,.13,.89,.05,.17],b1=[,,73,.02,.06,.96,4,.1,5.6,-7.4,,,.37,2.6,,.3,.3,.8,.16],E1=[,,250,.13,.25,.83,1,.7,,-.3,,,,,17,,,,.02,,23];var M1={palette:[[124,124,124],[0,0,252],[0,0,188],[68,40,188],[148,0,132],[168,0,32],[168,16,0],[136,20,0],[80,48,0],[0,120,0],[0,104,0],[0,88,0],[0,64,88],[0,0,0],[188,188,188],[0,120,248],[0,88,248],[104,68,252],[216,0,204],[228,0,88],[248,56,0],[228,92,16],[172,124,0],[0,184,0],[0,168,0],[0,168,68],[0,136,136],[248,248,248],[60,188,252],[104,136,252],[152,120,248],[248,120,248],[248,88,152],[248,120,88],[252,160,68],[248,184,0],[88,216,84],[88,248,152],[0,232,216],[120,120,120],[252,252,252],[164,228,252],[184,184,248],[216,184,248],[248,184,248],[248,164,192],[240,208,176],[252,224,168],[248,216,120],[216,248,120],[184,248,184],[184,248,216],[0,252,252],[216,216,216]],step:1,errorDiffusionDither:function(t,i,e){var s=new Uint8ClampedArray(t.data),a=new Uint8ClampedArray(t.data),r=this.step,h=1/16;new Array([1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]);for(var n=0;n<e;n+=r)for(var o=0;o<i;o+=r)for(var l=4*o+4*n*i,d=function(t,e){return 4*t+4*e*i},c=l,p=1+l,g=2+l,f=new Array(s[c],s[p],s[g]),f=this.approximateColor(f),u=[],x=(u[c]=s[c]-f[0],u[p]=s[p]-f[1],u[g]=s[g]-f[2],s[d(o+r,n)]=s[d(o+r,n)]+7*h*u[c],s[d(o-r,n+1)]=s[d(o-1,n+r)]+3*h*u[c],s[d(o,n+r)]=s[d(o,n+r)]+5*h*u[c],s[d(o+r,n+r)]=s[d(o+1,n+r)]+h*u[c],s[d(o+r,n)+1]=s[d(o+r,n)+1]+7*h*u[p],s[d(o-r,n+r)+1]=s[d(o-r,n+r)+1]+3*h*u[p],s[d(o,n+r)+1]=s[d(o,n+r)+1]+5*h*u[p],s[d(o+r,n+r)+1]=s[d(o+r,n+r)+1]+h*u[p],s[d(o+r,n)+2]=s[d(o+r,n)+2]+7*h*u[g],s[d(o-r,n+r)+2]=s[d(o-r,n+r)+2]+3*h*u[g],s[d(o,n+r)+2]=s[d(o,n+r)+2]+5*h*u[g],s[d(o+r,n+r)+2]=s[d(o+r,n+r)+2]+h*u[g],f[0]),w=f[1],m=f[2],y=0;y<r;y++)for(var C=0;C<r;C++){var v=l+4*y+4*i*C;a[v]=x,a[1+v]=w,a[2+v]=m}return a},dither:function(t,e,i){for(var s=new Uint8ClampedArray(t.data),a=new Array([1,9,3,11],[13,5,15,7],[4,12,2,10],[16,8,14,6]),r=0;r<i;r+=1)for(var h=0;h<e;h+=1)for(var n=4*h+4*r*e,o=n,l=1+n,d=2+n,o=(s[o]+=2*a[h%4][r%4],s[l]+=2*a[h%4][r%4],s[d]+=2*a[h%4][r%4],new Array(s[o],s[l],s[d])),l=this.approximateColor(o),c=l[0],p=l[1],g=l[2],f=0;f<1;f++)for(var u=0;u<1;u++){var x=n+4*f+4*e*u;s[x]=c,s[1+x]=p,s[2+x]=g}return s},approximateColor:function(t){function r(t,e,i,s){var a;return 2==i.length?t(e,s)<=t(e,i[1])?s:i[1]:(a=i.slice(1),t(e,s)<=t(e,i[1])||(s=i[1]),r(t,e,a,s))}var e=this.palette;return r(this.colorDistance,t,e,e[0])},colorDistance:function(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}};class O1{constructor(t){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.imageSmoothingEnabled=!1,this.image=new Image,Object.assign(this,t)}async generate(t,e){this.canvas.width=t,this.canvas.height=e,this.draw&&await this.draw(this.ctx);var i=this.ctx.getImageData(0,0,t,e),i=new ImageData(M1.dither(i,t,e),t,e);return this.ctx.putImageData(i,0,0),this.image.src=this.canvas.toDataURL(),new Promise(t=>{this.image.onload=()=>t(this.image)})}}function u(t){return new O1(t)}var x=async(e="white")=>{const s=new Image,a=(s.src="font.png",{white:["rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(63, 63, 63)"],yellow:["rgb(255, 255, 255)","rgb(255, 255, 127)","rgb(255, 255, 127)","rgb(127, 127, 63)"],red:["rgb(255, 0, 0)","rgb(255, 0, 0)","rgb(63, 0, 0)"],green:["rgb(0, 127, 0)","rgb(0, 127, 0)","rgb(0, 63, 0)"],lightgreen:["rgb(0, 255, 63)","rgb(0, 255, 63)","rgb(0, 63, 31)"],gray:["rgb(127, 127, 127)","rgb(127, 127, 127)","rgb(63, 63, 63)"],lightblue:["rgb(0, 254, 254)","rgb(0, 127, 127)","rgb(0, 63, 63)"]});return new Promise(t=>{s.onload=()=>{t(u({async draw(i){i.drawImage(s,0,0),i.save(),i.globalCompositeOperation="source-in";var t=i.createLinearGradient(0,0,0,8),t=(t.addColorStop(0,a[e][0]),t.addColorStop(.5,a[e][1]),t.addColorStop(1,a[e][2]),i.fillStyle=t,i.fillRect(0,0,378,9),i.getImageData(0,0,378,9)),t=await createImageBitmap(t);i.globalCompositeOperation="source-over",i.clearRect(0,0,378,9);for(let e=-1;e<2;e++)for(let t=-1;t<2;t++)i.drawImage(s,e,t);i.drawImage(t,0,0)}}))}})},w=(w=document.getElementById("c").getContext("2d",{willReadFrequently:!0}),window.zyxplay=window.zyxplay||{},window.zyxplay.context=w);w.imageSmoothingEnabled=!1,w.setTransform(1,0,0,1,0,0),BassoonTracker.init(!0),(async()=>{{let t;for(t=0;t<26;t++)c["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)c["Digit"+t]=c["Numpad"+t]=""+t;window.addEventListener("keydown",E),window.addEventListener("keyup",M)}await s("song1",u1,x1),await s("explosion",I,w1),await s("shoot",I,m1),await s("shoot2",I,H1),await s("typing",I,y1),await s("powerup",I,C1),await s("hit",I,S1),await s("transition",I,v1),await s("engineSlowdown",I,E1),await s("bigExplosion",I,b1),await a("spritesheet.png"),await a("spritesheet16.png");var t=u({draw(t){var e=new Path2D("M42.125 56V47.7188H52.375V38.875H42.125V31.6562H52.375V22.8125H42.125V14.5312H58.1562L66.4688 22.8125V31.25L62.3125 35.4062L66.4688 39.5625V47.7188L58.1562 56H42.125ZM26.125 56V14.5312H39.9375V56H26.125ZM72.875 56V14.5312H86.6875V56H72.875ZM88.875 56V47.7188H95.7188V42.4688H108.25V56H88.875ZM113.5 56V47.1562H117.656V23.3438H113.5V14.5312H135.625V23.3438H131.469V47.1562H135.625V56H113.5ZM167.375 56L142.25 14.5312H156.844L182.062 56H167.375ZM182.062 52.0625L170.031 32.25V14.5312H182.062V52.0625ZM142.25 56V18.4688L154.281 38.1875V56H142.25ZM204.75 56V47.7188H215V22.8125H204.75V14.5312H220.531L228.844 22.8125V47.7188L220.531 56H204.75ZM188.75 56V14.5312H202.562V56H188.75ZM40.4062 111V69.5312H54.2188V88.0625H66.9688V96.2188H54.2188V111H40.4062ZM63.6562 83.2812V77.8125H56.4062V69.5312H77.4688V83.2812H63.6562ZM83.5312 111V69.5312H97.3438V85.9688H110.562V93.9688H97.3438V111H83.5312ZM108.125 81.5312V77.5625H99.5312V69.5312H121.125V81.5312H108.125ZM99.5312 111V102.719H107.312V98.5625H121.125V111H99.5312ZM156.812 111L155.062 106.469H141.5L144.375 98.25H151.875L140.781 69.5312H154.25L170.781 111H156.812ZM124.469 111L139.281 71.4062L145.406 87.875L137.812 111H124.469ZM190.469 98.5625V90.5312H200.844V77.8125H190.469V69.5312H206.25L214.562 77.8125V90.25L208.125 96.6875L215.969 111H201.219L195.344 98.5625H190.469ZM174.469 111V69.5312H188.281V111H174.469Z"),i=(t.fillStyle="white",t.fill(e),t.globalCompositeOperation="source-in",t.createLinearGradient(0,20,0,80));i.addColorStop(0,"rgb(255, 255, 255, 1)"),i.addColorStop(.21,"rgb(0, 255, 255, 1)"),i.addColorStop(1,"rgb(0, 0, 255, 1)"),t.fillStyle=i,t.fillRect(0,0,256,240),t.globalCompositeOperation="source-over",t.strokeStyle="white",t.lineWidth=5,t.stroke(e),t.strokeStyle="black",t.lineWidth=2,t.stroke(e)}}),t=(await t.generate(256,240),await a("title.png",t.image),u({draw(t){t.save(),t.translate(0,-100);var e=new Path2D("M42 166L33.7188 157.719V132.812L42 124.531H47.5312V157.719H59.375V166H42ZM60 136.969V132.812H49.7188V124.531H66.5625L73.8125 132.812V136.969H60ZM61.5625 166V151.219H54.8438V143H73.8125V166H61.5625ZM109.5 166L107.75 161.469H94.1875L97.0625 153.25H104.562L93.4688 124.531H106.938L123.469 166H109.5ZM77.1562 166L91.9688 126.406L98.0938 142.875L90.5 166H77.1562ZM151.781 166L127.188 124.531H141.875L153 142.969L161.75 127.969V148.844L151.781 166ZM163.781 166V124.531H177.594V166H163.781ZM127.156 166V128.375L140.062 150.031V166H127.156ZM184.281 166V124.531H198.094V140.969H211.312V148.969H198.094V166H184.281ZM208.875 136.531V132.562H200.281V124.531H221.875V136.531H208.875ZM200.281 166V157.719H208.062V153.562H221.875V166H200.281ZM61.5 221V212.562H66.7812V187.938H61.5V179.531H72.2188L80.5938 187.812V212.719L72.2188 221H61.5ZM48.6875 221L40.2812 212.719V187.812L48.6875 179.531H59.3125V187.938H54.125V212.562H59.3125V221H48.6875ZM97.7188 221L82.7188 179.531H96.8125L111.156 221H97.7188ZM112.844 219.75L106.625 201.5L113.312 179.531H127.188L112.844 219.75ZM130.625 221V179.531H144.438V195.969H157.656V203.969H144.438V221H130.625ZM155.219 191.531V187.562H146.625V179.531H168.219V191.531H155.219ZM146.625 221V212.719H154.406V208.562H168.219V221H146.625ZM190.625 208.562V200.531H201V187.812H190.625V179.531H206.406L214.719 187.812V200.25L208.281 206.688L216.125 221H201.375L195.5 208.562H190.625ZM174.625 221V179.531H188.438V221H174.625Z"),i=(t.fillStyle="white",t.fill(e),t.restore(),t.globalCompositeOperation="source-in",t.createLinearGradient(0,20,0,120));i.addColorStop(0,"rgb(255, 255, 255, 1)"),i.addColorStop(.31,"rgb(255, 255, 0, 1)"),i.addColorStop(.71,"rgb(172, 124 ,0, 1)"),i.addColorStop(1,"rgb(248, 56 ,0, 1)"),t.fillStyle=i,t.fillRect(0,0,256,240),t.globalCompositeOperation="source-over",t.save(),t.translate(0,-100),t.strokeStyle="white",t.lineWidth=5,t.stroke(e),t.strokeStyle="black",t.lineWidth=2,t.stroke(e),t.restore()}})),t=(await t.generate(256,240),await a("gameover.png",t.image),await(async()=>{const e=new Image;return e.src="data:image/svg+xml,"+encodeURIComponent(`
    <svg width="200" height="144" viewBox="0 0 200 144" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M142.301 99.9813C158.007 76.187 151.45 44.1656 127.656 28.4595C103.862 12.7534 71.8401 19.3102 56.134 43.1046C40.4279 66.8989 46.9848 98.9202 70.7792 114.627C94.5734 130.333 126.595 123.775 142.301 99.9813Z" fill="#E5B883"/>
    <path d="M142.301 99.9813C158.007 76.187 151.45 44.1656 127.656 28.4595C103.862 12.7534 71.8401 19.3102 56.134 43.1046C40.4279 66.8989 46.9848 98.9202 70.7792 114.627C94.5734 130.333 126.595 123.775 142.301 99.9813Z" fill="#E5B883"/>
    <path opacity="0.41" d="M81.7066 89.9633C71.4796 91.0997 61.7398 91.9113 51.9998 92.3983C55.7334 100.839 61.5773 107.982 68.8823 113.339C83.33 117.073 100.05 118.047 105.407 111.391C98.427 111.229 91.1219 110.417 84.6285 107.496C89.6609 109.443 107.842 108.794 111.414 104.411C109.952 104.249 108.654 103.761 107.193 103.599C116.77 101.976 140.309 101.489 145.827 92.723C140.146 92.0736 134.627 96.2947 129.432 93.21C134.302 90.1257 141.607 89.9633 148.263 88.6647C149.074 86.5544 149.562 84.2818 150.048 82.009C134.79 85.2557 117.907 96.7814 104.108 90.775C110.439 87.6907 120.017 89.4763 124.887 83.47C118.231 82.1714 110.115 87.2037 103.459 89.1517C93.0698 92.0736 80.7326 95.8071 70.0187 94.9959C73.5899 94.1838 78.9469 92.3983 81.7066 89.9633Z" fill="#AC2024"/>
    <path opacity="0.41" d="M50.5374 54.4124C50.375 54.7371 50.375 55.0618 50.2127 55.3864C57.193 53.9254 66.6083 48.2438 73.751 46.1335C83.8156 43.3737 93.5552 44.0232 103.783 43.2114C98.2629 43.5361 93.8806 47.1075 89.1725 49.3801C95.3407 50.3541 101.835 47.1075 107.678 45.3218C118.068 42.0751 128.781 38.6661 137.548 36.8805C136.736 36.0688 135.924 35.2572 135.112 34.4455C119.529 33.1469 104.107 34.1209 88.3609 35.7442C72.4523 37.3675 63.5239 48.2438 50.5374 54.4124Z" fill="#AC2024"/>
    <path opacity="0.41" d="M48.5897 81.6844C54.9207 81.3597 64.9853 77.4637 68.719 76.9767C73.7512 76.1651 79.7576 75.5157 85.6015 75.5157C87.5496 76.1651 89.8222 76.4897 91.6078 76.4897C92.7441 76.4897 93.8807 76.3274 94.8542 76.1651C95.1796 76.1651 95.5041 76.3274 95.9908 76.3274L95.0164 76.1651C102.322 75.1911 109.627 72.2691 116.12 69.5094C126.185 65.4511 139.009 63.1785 149.073 57.8215C148.911 57.0098 148.587 56.3605 148.424 55.7112C135.6 61.3929 122.614 66.1004 109.139 70.3211C104.594 71.7821 96.8029 75.6781 91.1208 75.3534L88.5235 74.8664C75.3746 69.5095 95.8285 59.7695 97.1274 68.2108C96.153 65.6135 88.5235 67.5615 90.3092 72.2691C94.6919 71.9445 101.51 70.6458 103.621 66.4251C97.9385 63.6655 85.7639 58.9579 81.2185 66.1005C79.1082 69.3472 80.0822 71.9445 82.0302 73.7301C71.8032 73.8924 57.8427 73.7301 48.1027 78.4377C48.2651 79.4117 48.4274 80.2234 48.5897 81.1974C48.4274 81.1974 48.4274 81.3597 48.5897 81.6844Z" fill="#AC2024"/>
    <path opacity="0.82" d="M65.3105 37.0428C64.0119 37.3675 61.9015 37.8546 59.4666 38.5039C57.0315 41.4258 54.9212 44.5101 53.2979 47.9191C56.7069 46.4581 59.9536 44.8348 60.9276 44.3478C67.7456 40.9388 75.3751 37.3675 83.0048 35.2572C93.8807 32.3352 104.919 33.7962 115.796 32.1729C112.225 30.5496 106.543 31.3612 103.458 29.4133C110.115 25.0302 120.503 29.0886 129.594 30.0626C126.672 27.9523 123.588 26.1665 120.179 24.7056C114.985 24.7056 110.115 25.1926 106.38 25.5172C93.7184 26.3289 82.1931 30.5496 65.3105 37.0428Z" fill="#FFEACC"/>
    <path opacity="0.82" d="M115.957 72.756C119.528 72.756 123.1 71.782 126.671 72.269C119.042 78.6 104.594 79.2493 95.0164 79.8986C80.2442 81.0349 64.1732 82.9829 49.7256 86.8788C49.7256 86.8788 49.7256 86.8788 49.7256 87.0412C66.2836 87.3658 84.6272 80.7103 101.347 82.4959C99.3996 86.5542 92.7438 87.2035 89.0101 89.9632C96.6397 93.5346 111.25 83.6322 118.555 80.7103C128.295 76.8142 140.632 73.8923 150.697 68.6977C150.534 67.2366 150.372 65.6133 150.21 63.99C138.684 66.9119 125.373 67.7236 115.957 72.756Z" fill="#FFEACC"/>
    <path opacity="0.82" d="M121.64 51.8151C119.692 58.3083 111.9 56.8473 107.193 59.2824C111.576 60.7434 116.283 57.0097 120.504 57.8213C119.205 60.9057 115.147 62.6913 112.549 65.2886C120.179 64.3147 127.321 60.4187 133.815 56.685C137.224 54.737 141.769 52.6267 146.152 50.1918C145.341 48.406 144.367 46.7827 143.392 45.1594C139.01 45.3218 134.464 45.1594 130.243 45.9711C123.588 47.1074 117.095 48.5685 110.601 50.3541C100.212 53.1137 89.9851 53.4384 79.9205 55.8734C81.5438 56.0357 83.0049 57.0097 84.4659 57.3343C77.8102 65.7756 54.272 61.555 47.6163 69.0223C47.6163 69.5093 47.6163 70.1587 47.6163 70.6457C72.4532 66.9119 96.6406 53.6007 121.64 51.8151Z" fill="#FFEACC"/>
    <path opacity="0.82" d="M125.535 109.768C120.827 109.443 108.653 114.962 105.893 118.533C112.548 121.455 137.223 108.956 139.495 102.3C133.651 101.165 118.879 107.008 113.847 110.742C115.146 111.229 115.957 110.742 117.58 110.579L125.535 109.768Z" fill="#FFEACC"/>
    <path opacity="0.23" d="M89.9848 20.8097C61.9012 25.842 43.233 52.7892 48.4277 80.8727C48.7523 82.1714 48.9147 83.47 49.4017 84.931C50.8626 86.2296 52.4859 87.366 54.2717 88.5024C72.1282 99.3782 91.4457 95.1581 107.192 82.8207C118.88 73.5677 127.483 59.4448 127.159 44.1856C126.834 33.9587 122.776 27.303 116.607 22.9201C108.166 19.998 99.075 19.1864 89.9848 20.8097Z" fill="#FFEACC"/>
    <path opacity="0.28" d="M82.1927 28.6017C61.4142 28.1147 49.7263 62.5292 66.4464 74.5418C103.945 101.489 123.1 15.2904 82.1927 28.6017Z" fill="#FFEACC"/>
    <path opacity="0.21" d="M150.048 62.3667C148.1 51.8151 143.23 42.5621 136.249 35.5818C136.411 36.2311 136.411 36.7181 136.574 37.3674C137.71 46.6204 136.574 56.3603 133.165 65.2886C122.289 93.8592 92.7441 108.793 63.5244 102.462C61.5763 101.976 58.979 101.165 56.2194 100.19C67.258 116.91 87.5496 126.325 108.49 122.592C136.411 117.398 155.08 90.4501 150.048 62.3667Z" fill="#AC2024"/>
    <path opacity="0.28" d="M150.048 62.3668C149.074 57.3345 147.613 52.7892 145.34 48.4062C143.717 54.8995 143.23 61.8798 142.255 68.3732C140.47 79.8988 135.762 85.5803 126.834 93.21C115.471 102.95 100.698 111.716 85.2771 111.716C78.6215 111.716 72.1282 109.93 65.6349 110.904C70.6672 115.124 76.5112 118.534 82.6798 120.644C88.6861 120.807 94.3674 120.32 97.2895 119.994C123.1 117.235 141.282 101.651 150.21 79.7364C151.022 74.0547 151.022 68.2108 150.048 62.3668Z" fill="#AC2024"/>
    <path opacity="0.74" d="M126.509 27.7899C128.296 28.9263 130.081 30.2249 131.704 31.5236C156.541 27.7899 175.047 30.7119 178.456 40.2895C183.65 54.8994 151.833 79.5739 107.354 95.4825C62.8751 111.391 22.6168 112.528 17.4221 97.9179C14.0132 88.3399 26.6751 74.217 48.5899 61.2304C48.9146 59.2825 49.5639 57.3344 50.0509 55.3864C16.6104 72.9184 -4.00573 93.2099 0.701911 106.683C7.03287 124.702 56.7066 123.241 111.575 103.761C166.443 84.1193 205.728 53.7631 199.234 35.7442C194.527 22.1083 164.657 19.6733 126.509 27.7899Z" fill="#FFE4CC"/>
    <path opacity="0.74" d="M106.867 94.3459C149.399 79.087 179.755 55.5488 174.56 41.9129C171.476 33.4716 155.567 30.8743 133.977 33.4716C135.438 34.7703 136.899 36.2313 138.198 37.8546C148.912 38.0169 156.379 40.452 158.327 45.4842C162.547 56.5228 137.873 75.678 103.296 88.0153C68.7195 100.515 37.3893 101.489 33.331 90.4503C31.2207 84.6063 36.74 76.8144 47.6163 68.6977C47.7786 67.0744 47.9409 65.2888 48.1033 63.6655C28.461 75.678 17.2601 88.5023 20.5067 97.268C25.7014 111.067 64.3366 109.768 106.867 94.3459Z" fill="#EDCBAE"/>
    </svg>
  `),new Promise(t=>{e.onload=()=>{t(u({draw(t){t.drawImage(e,0,0)}}))}})})());await t.generate(256,240),await a("saturn.png",t.image);let e=await x();function i(t,e){let i="menu.mod";var s,a;switch(s=["change-scene"],a=Object.keys(h).reduce((t,e)=>(s.includes(e)&&(t[e]=h[e]),t),{}),h=a,t){case"menu":i="menu.mod",r=function(){F(["enter"],()=>{Z("change-scene","game")}),q(["esc"]);const t=G(90),e=D({x:128,y:48,anchor:{x:.5,y:.5},width:256,height:100,scaleX:.01,scaleY:.01,image:d["title.png"],update(){this.scaleX=this.scaleY=R(0,1,this.frame/200),this.advance()},draw(){var t;this.frame<2||(t=this["context"],t.drawImage(this.image,0,0))}}),i=D({x:0,y:72,anchor:{x:.5,y:.5},width:30,height:200,ttl:1/0,dx:5,limit:1e3*k(1,2),update(){this.x>this.limit&&(this.x=0,this.limit=1e3*k(1,2)),this.advance()},draw(){var t=this["context"];t.save(),t.globalCompositeOperation="source-atop",t.globalAlpha=.5,t.fillStyle="white",t.rotate(Math.PI/4),t.fillRect(-10,0,5,this.height),t.fillRect(0,0,this.width,this.height),t.fillRect(40,0,10,this.height),t.restore()}});var s=D({x:128,y:256,anchor:{x:.5,y:.5},width:8,height:8,image:d["spritesheet.png"],sprite:4,dy:-.5,spawn(){this.x=k(0,256),this.y=256,this.dy=-k(.5,1.5),this.sprite=Math.floor(k(3,9))},update(){this.y<-8&&(this.y=-8,T(()=>this.spawn(),k(1e3,2e3))),this.advance()},draw(){var t=this["context"];t.save(),t.drawImage(this.image,8*this.sprite,0,8,8,0,0,8,8),t.restore()}}),a=D({x:224,y:376,anchor:{x:.5,y:.5},width:256,height:240,image:d["saturn.png"],dy:-.7,update(){this.y<240&&(this.dy=0),this.advance()},draw(){var t=this["context"];t.save(),t.drawImage(this.image,0,0,256,240),t.restore()}});j({x:128,y:24,text:"BLIND FEAR",align:"center",color:"red",scaleX:2,scaleY:4});const r=j({x:128,y:128,text:"DIRECTORS CUT EDITION",align:"center",color:"yellow"}),h=j({x:128,y:152,text:"HI SCORE: 0",align:"center",color:"green"}),n=(j({x:128,y:128,text:"A GAME BY\nMARCO FERNANDES",lineHeight:16,color:"white",align:"center"}),j({x:128,y:176,text:"ARROWS OR WASD TO MOVE\nSPACE TO SHOOT",lineHeight:16,align:"center"}));var o=j({x:128,y:224,text:"ENTER TO START",color:"lightgreen",align:"center"});h.text="HIGH SCORE: "+(localStorage.getItem("hiscore")||0);const l=N({frame:0,children:[t,a,s,o],update(){40<this.frame&&this.frame<180&&this.frame%20==0&&t.decreaseVel(2),this.frame++}});return T(()=>{l.add(e),l.add(i),P(_.engineSlowdown)},500),T(()=>{l.add(r)},2e3),T(()=>{l.add(h)},2500),T(()=>{l.add(n)},3e3),l}();break;case"game":i="music.xm",r=f1();break;case"game-over":i="game-over.mod",r=function({score:t=0,previous:e=localStorage.getItem("hiScore")||0}={}){F(["enter"],()=>{Z("change-scene","menu")}),z("explosion",(e,i,s,a,r)=>{P(_.explosion);for(let t=0;t<s;t++)h.get({x:e,y:i,dx:k(-a/2,a/2),dy:k(-a/2,a/2),color:r,ttl:30*a})});var i=G(1);const h=U({create:K,maxSize:400}),s=D({x:128,y:48,anchor:{x:.5,y:.5},width:256,height:100,scaleX:.01,scaleY:.01,image:d["gameover.png"],update(){this.scaleX=this.scaleY=R(0,1,this.frame/200),this.advance()},draw(){var t;this.frame<2||(t=this["context"],t.drawImage(this.image,0,0))}}),a=(j({x:128,y:32,text:"GAME OVER",align:"center",color:"red",scaleX:2,scaleY:4}),j({x:128,y:128,text:"YOUR SCORE:",color:"white",align:"center"})),r=j({x:128,y:144,text:""+t,color:"white",align:"center",scaleX:2,scaleY:2}),n=j({x:128,y:180,text:"NEW HIGH SCORE!",color:"yellow",align:"center"}),o=N({frame:0,children:[i,j({x:128,y:224,text:"ENTER TO CONTINUE",color:"lightgreen",align:"center"}),h]});return T(()=>{o.add(s)},1e3),T(()=>{o.add(a)},2e3),T(()=>{o.add(r)},2500),e<t&&T(()=>{o.add(n),Z("explosion",128,180,60,4,"yellow")},3e3),o}(e)}BassoonTracker.load(i,!0)}await e.generate(378,9),await a("font-white.png",e.image),await(e=await x("yellow")).generate(378,9),await a("font-yellow.png",e.image),await(e=await x("red")).generate(378,9),await a("font-red.png",e.image),await(e=await x("green")).generate(378,9),await a("font-green.png",e.image),await(e=await x("lightgreen")).generate(378,9),await a("font-lightgreen.png",e.image),await(e=await x("gray")).generate(378,9),await a("font-gray.png",e.image),await(e=await x("lightblue")).generate(378,9),await a("font-lightblue.png",e.image),z("change-scene",(t,e)=>i(t,e));let r=function(){F(["enter"],()=>{Z("change-scene","menu")});const t=j({x:128,y:120,text:"LOADING",color:"lightgreen",align:"center"});return T(async()=>{t.text="PRESS ENTER TO CONTINUE"},1e3),N({id:"loading",frame:0,children:[t]})}();N({frame:0,children:[D({x:128,y:128,width:16,height:16,anchor:{x:.5,y:.5},update(){this.advance()},draw(){var t=this["context"];t.fillStyle="white",t.fillRect(0,0,this.width,this.height)}})]}),function({update:t,render:e}){let i=0,s,a,r;const h=o();function n(){if(requestAnimationFrame(n),a=performance.now(),r=a-s,s=a,!(1e3<r)){for(i+=r;i>=1e3/60;)t(1/60),i-=1e3/60;h.clearRect(0,0,h.canvas.width,h.canvas.height),e()}}return{start(){s=performance.now(),requestAnimationFrame(n)}}}({update(t){r.update(t)},render(){r.render()}}).start()})()}();